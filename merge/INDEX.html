<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AAYAT ACADEMY | Complete Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        .glass-card { background: rgba(152, 240, 235, 0.9); backdrop-filter: blur(10px); }
        .hover-scale { transition: transform 0.2s; }
        .hover-scale:hover { transform: scale(1.02); }
        html { scroll-behavior: smooth; }
        .input-field { @apply w-full px-4 py-2 border-2 border-indigo-300 rounded-lg focus:border-indigo-600 focus:outline-none transition; }
        .login-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .section { display: none; }
        .section.active { display: block; }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .animate-bounce { animation: bounce 2s infinite; }
        .chatbot-scrollbar::-webkit-scrollbar { width: 6px; }
        .chatbot-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        .chatbot-scrollbar::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        .chatbot-scrollbar::-webkit-scrollbar-thumb:hover { background: #555; }
    </style>
</head>
<body class="bg-gradient-to-b from-indigo-100 via-blue-100 to-white min-h-screen">
    <div class="bg-red-600 text-white text-center py-2 px-4 font-bold animate-pulse">
        üöÄ ADMISSION OPEN 2026 - JOIN TODAY AAYAT ACADEMY COMPUTER TRAINING INSTITUTE !
    </div>

    <nav class="bg-indigo-900 text-white sticky top-0 z-50 shadow-xl">
        <div class="container mx-auto px-4 py-3 flex flex-wrap justify-between items-center gap-4">
            <div class="flex items-center gap-2">
                <span class="text-xl font-black tracking-tighter">AAYAT ACADEMY</span>
            </div>
            <div class="flex gap-4 text-sm font-medium flex-wrap">
                <button onclick="switchSection('home')" class="hover:text-yellow-400 transition">üè† Home</button>
                <a href="#notes" class="hover:text-yellow-400">üìö Study Notes</a>
                <button onclick="switchSection('student')" class="bg-green-500 text-white px-3 py-1 rounded-full font-bold hover:bg-green-600">üë®‚Äçüéì Student</button>
                <button onclick="switchSection('admin')" class="bg-purple-600 text-white px-3 py-1 rounded-full font-bold hover:bg-purple-700">üîê Admin</button>
                <a href="tel:+918181867118" class="bg-yellow-500 text-indigo-900 px-3 py-1 rounded-full font-bold">üìû 8181867118</a>
            </div>
        </div>
    </nav>

    <!-- ============== HOME SECTION ============== -->
    <div id="home" class="section active">
        <header class="bg-indigo-800 text-white py-16 px-4 text-center">
            <div class="logo flex justify-center items-center py-6">
                <img src="https://dynamic.exportersindia.com/company_logo/12186228.jpg" 
                     alt="Aayat Academy Logo" 
                     class="h-24 w-24 rounded-full shadow-lg border-2 border-indigo-900">
            </div>
            <h1 class="text-4xl md:text-5xl font-extrabold mb-2">WELCOME TO AAYAT ACADEMY</h1>
            <h2 class="text-2xl md:text-4xl font-extrabold mb-2">COMPUTER TRAINING INSTITUTE</h2>
            <p class="text-indigo-200 text-lg mb-8 italic">"Quality Education for a Brighter Future"</p>
            
            <div class="max-w-2xl mx-auto mb-6">
                <input type="text" id="noteSearch" onkeyup="searchNotes()" 
                       placeholder="Search for Tally, CCC, Java, Python, Dca, Adca, Bca, O-Level..." 
                       class="w-full p-4 rounded-full text-gray-800 shadow-2xl focus:ring-4 focus:ring-yellow-400 outline-none">
            </div>

            <div class="flex flex-wrap justify-center gap-3">
                <a href="https://aacti.aisc.in/online_admission" target="_blank" class="bg-white text-indigo-900 px-6 py-2 rounded-full font-bold hover:bg-yellow-400 transition">Fill Admission Form</a>
                <a href="https://aacti.aisc.in/" target="_blank" class="border border-white px-6 py-2 rounded-full font-bold hover:bg-white hover:text-indigo-900 transition">Official Website</a>
            </div>
        </header>
            
        <main class="container mx-auto py-10 px-4">
            <div class="container mx-auto p-5">
                <h2 id="notes" class="text-3xl font-bold mb-8 text-center border-b-4 border-indigo-900 inline-block">Study Notes</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-20" id="notesGrid">
                    <div class="glass-card p-6 rounded-2xl shadow-lg border-t-4 border-orange-500 hover-scale">
                        <h3 class="text-xl font-bold mb-4 flex items-center gap-2 text-orange-600"><i data-lucide="book-open"></i> CCC Course</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center border-b pb-2">
                                <span>Unit 1: CCC SYLLABUS</span>
                                <a href="https://drive.google.com/file/d/1TQDo9820IUhD-PhCdOhJ1G8tRyxTPH5M/view?usp=sharing" target="_blank" class="text-orange-600 font-bold hover:underline">View üëÅÔ∏è</a>
                            </div>
                            <div class="flex justify-between items-center border-b pb-2">
                                <span>Unit 2: CCC HINDI NOTES</span>
                                <a href="https://drive.google.com/file/d/1X8fOgX6_GxrZ-zoSKGZN5vrqihCf0cyN/view?usp=drive_link" target="_blank" class="text-orange-600 font-bold hover:underline">View üëÅÔ∏è</a>
                            </div>
                            <div class="flex justify-between items-center border-b pb-2">
                                <span>Unit 2: CCC ENGLISH NOTES</span>
                                <a href="https://drive.google.com/file/d/1X8fOgX6_GxrZ-zoSKGZN5vrqihCf0cyN/view?usp=drive_link" target="_blank" class="text-orange-600 font-bold hover:underline">View üëÅÔ∏è</a>
                            </div>
                        </div>
                    </div>

                    <div class="glass-card p-6 rounded-2xl shadow-lg border-t-4 border-blue-600 hover-scale">
                        <h3 class="text-xl font-bold mb-4 flex items-center gap-2 text-blue-600"><i data-lucide="layers"></i> ADCA</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center border-b pb-2">
                                <span>Module 1: ADCA SYLLABUS</span>
                                <a href="https://drive.google.com/file/d/1RgVrKvtJsK2JKdd8W7EDD13IDQdsJmUW/view?usp=drive_link" class="text-blue-600 font-bold hover:underline">View üëÅÔ∏è</a>
                            </div>
                            <div class="flex justify-between items-center border-b pb-2">
                                <span>Module 2: ADCA ENGLISH NOTES</span>
                                <a href="https://drive.google.com/file/d/1Kl73hlxVwcLqMAZuOF8HJ4BZzmpkyKpH/view?usp=drive_link" class="text-blue-600 font-bold hover:underline">View üëÅÔ∏è</a>
                            </div>
                        </div>
                    </div>

                    <div class="glass-card p-6 rounded-2xl shadow-lg border-t-4 border-indigo-600 hover-scale">
                        <h3 class="text-xl font-bold mb-4 flex items-center gap-2 text-indigo-600"><i data-lucide="file-text"></i> DCA</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center border-b pb-2">
                                <span>DCA Fundamental Notes</span>
                                <a href="#" class="text-indigo-600 font-bold hover:underline">View üëÅÔ∏è</a>
                            </div>
                        </div>
                    </div>

                    <div class="glass-card p-6 rounded-2xl shadow-lg border-t-4 border-red-600 hover-scale">
                        <h3 class="text-xl font-bold mb-4 flex items-center gap-2 text-red-600"><i data-lucide="graduation-cap"></i> BCA Help Notes</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center border-b pb-2">
                                <span>C Programming Basics</span>
                                <a href="#" class="text-red-600 font-bold hover:underline">View üëÅÔ∏è</a>
                            </div>
                        </div>
                    </div>

                    <div class="glass-card p-6 rounded-2xl shadow-lg border-t-4 border-yellow-600 hover-scale">
                        <h3 class="text-xl font-bold mb-4 flex items-center gap-2 text-yellow-600"><i data-lucide="award"></i> O-LEVEL (NIELIT)</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center border-b pb-2">
                                <span>M1-R5: IT Tools</span>
                                <a href="#" class="text-yellow-600 font-bold hover:underline">View üëÅÔ∏è</a>
                            </div>
                        </div>
                    </div>

                    <div class="glass-card p-6 rounded-2xl shadow-lg border-t-4 border-blue-400 hover-scale">
                        <h3 class="text-xl font-bold mb-4 flex items-center gap-2 text-blue-500"><i data-lucide="terminal"></i> PYTHON</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center border-b pb-2">
                                <span>Python Intro & Syntax</span>
                                <a href="#" class="text-blue-500 font-bold hover:underline">View üëÅÔ∏è</a>
                            </div>
                        </div>
                    </div>
                </div>

                <section id="social" class="bg-white rounded-3xl p-8 shadow-inner border border-gray-200">
                    <h3 class="text-2xl font-black text-center mb-10 text-indigo-900 uppercase">Connect with AAYAT ACADEMY</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
                        <a href="https://www.instagram.com/aayatacademyvns/" class="flex flex-col items-center hover:text-pink-600 transition">
                            <i data-lucide="instagram" class="w-10 h-10 mb-2"></i>
                            <span class="text-xs font-bold uppercase tracking-widest">Instagram</span>
                        </a>
                        <a href="https://www.youtube.com/@aacti" class="flex flex-col items-center hover:text-red-600 transition">
                            <i data-lucide="youtube" class="w-10 h-10 mb-2"></i>
                            <span class="text-xs font-bold uppercase tracking-widest">YouTube</span>
                        </a>
                        <a href="https://whatsapp.com/channel/0029Va4qzgn1noz8smaD8J2q" class="flex flex-col items-center hover:text-green-500 transition">
                            <i data-lucide="message-circle" class="w-10 h-10 mb-2"></i>
                            <span class="text-xs font-bold uppercase tracking-widest">WhatsApp</span>
                        </a>
                        <a href="https://t.me/+iyJK_OXSjhFkMDc1" class="flex flex-col items-center hover:text-blue-500 transition">
                            <i data-lucide="send" class="w-10 h-10 mb-2"></i>
                            <span class="text-xs font-bold uppercase tracking-widest">Telegram</span>
                        </a>
                    </div>
                </section>

                <section class="mt-12 bg-gradient-to-r from-indigo-900 to-blue-900 text-white rounded-3xl p-8 shadow-2xl">
                    <div class="flex flex-col md:flex-row items-center gap-8">
                        <div class="flex-1">
                            <h3 class="text-2xl font-bold mb-4">AAYAT FOUNDATION</h3>
                            <p class="text-indigo-100 mb-4 text-sm leading-relaxed">
                                Help Us Educate ‚Ä¢ Empower ‚Ä¢ Transform Lives
                            </p>
                            <div class="bg-indigo-800 p-4 rounded-lg inline-block border border-indigo-400">
                                <p class="text-xs uppercase font-bold text-indigo-300 mb-1">Fee Payment / Donation UPI ID</p>
                                <p class="text-xl font-mono select-all">8181867118@ybl</p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <footer class="bg-gray-800 text-gray-400 py-12 px-4 text-center">
            <div class="container mx-auto">
                <p class="text-white font-bold mb-4 uppercase tracking-wider">¬© 2017 AAYAT ACADEMY | Empowerment through Education</p>
                <p class="text-xs uppercase tracking-widest">Enquiry: +91 8181867118</p>
            </div>
        </footer>
    </div>

    <!-- ============== AACTI CHATBOT ============== -->
    <button id="chatbotButton" onclick="toggleChatbot()" class="fixed bottom-8 right-8 bg-gradient-to-r from-blue-600 to-purple-600 text-white w-16 h-16 rounded-full shadow-2xl hover:shadow-3xl transition-all animate-bounce flex items-center justify-center z-40 border-2 border-white">
        <i data-lucide="message-circle" class="w-8 h-8"></i>
    </button>

    <div id="chatbotModal" class="fixed bottom-24 right-8 w-96 bg-white rounded-2xl shadow-2xl z-40 hidden flex flex-col max-h-96 border-4 border-blue-600">
        <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-4 rounded-t-lg flex items-center justify-between">
            <div>
                <h3 class="text-lg font-bold flex items-center gap-2">ü§ñ AACTI CHATBOT</h3>
                <p class="text-xs text-blue-100">AI-Powered Student Assistant</p>
            </div>
            <button onclick="toggleChatbot()" class="text-white hover:text-blue-200 font-bold text-xl">‚úï</button>
        </div>
        
        <div id="chatMessages" class="flex-1 p-4 space-y-3 overflow-y-auto chatbot-scrollbar bg-gray-50">
            <div class="bg-blue-100 text-blue-900 p-3 rounded-lg rounded-tl-none text-sm">
                üëã Hello! I'm AACTI Chatbot. I'm here to help you with any questions about our courses, exams, fees, admission, or study materials. How can I assist you today?
            </div>
        </div>

        <div id="typingIndicator" class="hidden px-4 py-2">
            <div class="flex gap-2">
                <div class="w-2 h-2 bg-blue-600 rounded-full animate-bounce" style="animation-delay: 0s;"></div>
                <div class="w-2 h-2 bg-blue-600 rounded-full animate-bounce" style="animation-delay: 0.2s;"></div>
                <div class="w-2 h-2 bg-blue-600 rounded-full animate-bounce" style="animation-delay: 0.4s;"></div>
            </div>
        </div>

        <div class="border-t p-3 bg-white rounded-b-lg flex gap-2">
            <input type="text" id="chatInput" placeholder="Ask me anything..." class="flex-1 border-2 border-blue-300 rounded-lg px-3 py-2 focus:border-blue-600 focus:outline-none text-sm" onkeypress="if(event.key === 'Enter') sendChatMessage()">
            <button onclick="sendChatMessage()" class="bg-blue-600 hover:bg-blue-700 text-white rounded-lg px-4 py-2 font-bold transition">Send</button>
        </div>
    </div>

    <!-- ============== STUDENT PORTAL SECTION ============== -->
    <div id="student" class="section">
        <div class="container mx-auto py-8 px-4">
            <!-- Student Portal Tabs -->
            <div class="flex justify-center gap-4 mb-8 flex-wrap">
                <button onclick="switchStudentPortalTab('login')" class="student-portal-tab bg-indigo-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-indigo-700 transition">üîê Login</button>
                <button onclick="switchStudentPortalTab('admission')" class="student-portal-tab bg-green-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-green-700 transition">üìù New Admission</button>
            </div>

            <!-- Login Section -->
            <div id="studentLoginSection" class="student-portal-tab-content min-h-[calc(100vh-80px)] flex items-center justify-center px-4 py-8">
                <div class="max-w-md w-full">
                    <div class="login-card rounded-2xl shadow-2xl p-8 border-4 border-indigo-600">
                        <div class="text-center mb-8">
                            <div class="inline-block bg-indigo-600 text-white p-3 rounded-full mb-4">
                                <i data-lucide="lock" class="w-8 h-8"></i>
                            </div>
                            <h1 class="text-3xl font-bold text-indigo-900 mb-2">Student Login</h1>
                            <p class="text-gray-600">Access your AACTI Account</p>
                        </div>

                        <div class="space-y-4 mb-6">
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">üìß GMAIL</label>
                                <input type="email" id="studentEmail" placeholder="e.g., aman@gmail.com" class="input-field" autocomplete="email">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">üîê Password</label>
                                <div class="relative">
                                    <input type="password" id="studentPassword" placeholder="Enter your password" class="input-field" autocomplete="current-password">
                                    <button onclick="togglePasswordVisibility()" class="absolute right-3 top-3 text-gray-600 hover:text-indigo-600">
                                        <i data-lucide="eye" id="eyeIcon" class="w-5 h-5"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <button onclick="studentLogin()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg transition shadow-lg mb-4">üîì Login to Portal</button>

                        <div class="bg-blue-50 p-4 rounded-lg mb-4">
                            <p class="text-sm text-gray-700"><strong>üìù Demo Credentials:</strong></p>
                            <p class="text-xs text-gray-600">GMAIL: <span class="font-mono font-bold">aman@gmail.com</span></p>
                            <p class="text-xs text-gray-600">Password: <span class="font-mono font-bold">Pass@123</span></p>
                        </div>
                    </div>

                    <div class="mt-6 bg-white rounded-2xl shadow-lg p-6 border-l-4 border-green-600">
                        <h3 class="font-bold text-gray-800 mb-3 flex items-center gap-2">
                            <i data-lucide="shield-check" class="w-5 h-5 text-green-600"></i> Security Tips
                        </h3>
                        <ul class="text-sm text-gray-700 space-y-2">
                            <li>‚úì Never share your credentials with anyone</li>
                            <li>‚úì Change your password immediately after first login</li>
                            <li>‚úì Always logout after using shared computers</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Admission Form Section -->
            <div id="studentAdmissionSection" class="student-portal-tab-content hidden min-h-[calc(100vh-80px)] flex items-center justify-center px-4 py-8">
                <div class="max-w-2xl w-full">
                    <div class="bg-white rounded-2xl shadow-2xl p-8 border-4 border-green-600">
                        <div class="text-center mb-8">
                            <div class="inline-block bg-green-600 text-white p-3 rounded-full mb-4">
                                <i data-lucide="file-text" class="w-8 h-8"></i>
                            </div>
                            <h1 class="text-3xl font-bold text-indigo-900 mb-2">Student Admission Form</h1>
                            <p class="text-gray-600">Fill in your details to register with AACTI Academy</p>
                        </div>

                        <form id="admissionFormElement" onsubmit="submitAdmissionForm(event)" class="space-y-4">
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Full Name *</label>
                                    <input type="text" id="admissionName" placeholder="Enter your full name" class="input-field" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Email Address *</label>
                                    <input type="email" id="admissionEmail" placeholder="your@email.com" class="input-field" required>
                                </div>
                            </div>

                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Mobile Number *</label>
                                    <input type="tel" id="admissionPhone" placeholder="10-digit mobile number" class="input-field" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Select Course *</label>
                                    <select id="admissionCourse" class="input-field" required>
                                        <option value="">-- Select Course --</option>
                                        <option value="CCC">CCC Course</option>
                                        <option value="ADCA">ADCA (Advanced Diploma in Computer Applications)</option>
                                        <option value="DCA">DCA (Diploma in Computer Applications)</option>
                                        <option value="BCA">BCA (Bachelor of Computer Applications)</option>
                                        <option value="Python">Python Programming</option>
                                        <option value="Java">Java Programming</option>
                                        <option value="Tally">Tally ERP</option>
                                        <option value="O-Level">O-Level</option>
                                    </select>
                                </div>
                            </div>

                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Enrollment Date *</label>
                                    <input type="date" id="admissionEnrollDate" class="input-field" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Total Course Fees *</label>
                                    <input type="number" id="admissionFees" placeholder="e.g., 5000" class="input-field" required>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Address (Optional)</label>
                                <textarea id="admissionAddress" placeholder="Enter your address" class="input-field h-20"></textarea>
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">üì∑ Passport Size Photo (3x4 cm) *</label>
                                <div class="flex flex-col items-center justify-center border-2 border-dashed border-indigo-400 rounded-lg p-6 bg-indigo-50 cursor-pointer hover:border-indigo-600 hover:bg-indigo-100 transition" onclick="document.getElementById('admissionPhoto').click()">
                                    <i data-lucide="upload-cloud" class="w-12 h-12 text-indigo-600 mb-2"></i>
                                    <p class="text-sm font-bold text-gray-700 text-center">Click to upload or drag and drop</p>
                                    <p class="text-xs text-gray-600 text-center mt-1">PNG, JPG, JPEG (Max 2MB)</p>
                                    <input type="file" id="admissionPhoto" accept="image/*" class="hidden" onchange="handlePhotoUpload(event)" required>
                                </div>
                                <div id="photoPreview" class="mt-4 hidden">
                                    <p class="text-sm font-bold text-gray-700 mb-2">Photo Preview:</p>
                                    <img id="photoPreviewImg" src="" alt="Photo Preview" class="h-32 w-24 object-cover border-2 border-indigo-300 rounded-lg">
                                    <button type="button" onclick="clearPhoto()" class="mt-2 text-xs text-red-600 hover:underline font-bold">Remove Photo</button>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Create Your Password *</label>
                                <div class="relative">
                                    <input type="password" id="admissionPassword" placeholder="Min 6 characters, include numbers & letters" class="input-field" required minlength="6">
                                    <button type="button" onclick="toggleAdmissionPasswordVisibility()" class="absolute right-3 top-3 text-gray-600 hover:text-indigo-600">
                                        <i data-lucide="eye" class="w-5 h-5"></i>
                                    </button>
                                </div>
                                <p class="text-xs text-gray-600 mt-2">Password must be at least 6 characters with letters and numbers</p>
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Confirm Password *</label>
                                <div class="relative">
                                    <input type="password" id="admissionConfirmPassword" placeholder="Re-enter your password" class="input-field" required minlength="6">
                                    <button type="button" onclick="toggleAdmissionConfirmPasswordVisibility()" class="absolute right-3 top-3 text-gray-600 hover:text-indigo-600">
                                        <i data-lucide="eye" class="w-5 h-5"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                                <p class="text-xs text-gray-700"><strong>Note:</strong> Your Admission ID will be generated automatically. The password you set here will be used to login to your student portal.</p>
                            </div>

                            <div class="flex gap-4 pt-4">
                                <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg transition">‚úÖ Submit Admission Form</button>
                                <button type="reset" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 rounded-lg transition">üîÑ Clear Form</button>
                            </div>
                        </form>

                        <div id="admissionSuccessMessage" class="hidden mt-4 bg-green-100 border-2 border-green-600 rounded-lg p-4">
                            <h3 class="text-green-900 font-bold mb-2">‚úÖ Admission Successful!</h3>
                            <p class="text-sm text-green-800">Your admission has been submitted successfully. Your Admission ID has been generated and the password you set will be used to login to your student portal. Check the Admin Panel to see your details.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Section (Hidden by default) -->
            <div id="studentDashboardSection" class="hidden min-h-[calc(100vh-80px)] bg-gray-50 py-8">
                <div class="container mx-auto px-4">
                    <div class="text-right mb-6">
                        <button onclick="studentLogout()" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg font-bold">Logout</button>
                    </div>

                    <div class="bg-gradient-to-r from-indigo-600 to-blue-600 text-white rounded-2xl shadow-xl p-8 mb-8 text-center">
                        <h1 class="text-4xl font-bold mb-2">Welcome, <span id="studentNameDisplay"></span>! üëã</h1>
                        <p class="text-indigo-200">You are now logged into AACTI Student Portal</p>
                    </div>

                    <div class="grid md:grid-cols-2 gap-8">
                        <div class="bg-white rounded-2xl shadow-xl p-8 border-t-4 border-indigo-600">
                            <h2 class="text-2xl font-bold text-indigo-900 mb-6 flex items-center justify-center gap-2">
                                <i data-lucide="user" class="w-6 h-6"></i> Profile Information
                            </h2>
                            <div class="space-y-3">
                                <div class="flex justify-between border-b pb-2">
                                    <span class="font-bold text-gray-700">Full Name:</span>
                                    <span id="displayName" class="text-gray-800"></span>
                                </div>
                                <div class="flex justify-between border-b pb-2">
                                    <span class="font-bold text-gray-700">Email:</span>
                                    <span id="displayEmail" class="text-gray-800"></span>
                                </div>
                                <div class="flex justify-between border-b pb-2">
                                    <span class="font-bold text-gray-700">Course:</span>
                                    <span id="displayCourse" class="bg-blue-100 px-3 py-1 rounded text-blue-900 font-bold"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="font-bold text-gray-700">Admission ID:</span>
                                    <span id="displayAdmissionNo" class="text-gray-800 font-mono font-bold text-indigo-600"></span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow-xl p-8 border-t-4 border-blue-600">
                            <h2 class="text-2xl font-bold text-indigo-900 mb-6 flex items-center justify-center gap-2">
                                <i data-lucide="book" class="w-6 h-6"></i> Course Details
                            </h2>
                            <div class="space-y-3">
                                <div class="flex justify-between border-b pb-2">
                                    <span class="font-bold text-gray-700">Total Fees:</span>
                                    <span id="totalFees" class="text-gray-800 font-bold"></span>
                                </div>
                                <div class="flex justify-between border-b pb-2">
                                    <span class="font-bold text-gray-700">Status:</span>
                                    <span id="displayStatus" class="bg-green-100 px-3 py-1 rounded text-green-900 font-bold"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Announcements Section -->
                    <div class="bg-white rounded-2xl shadow-xl p-8 border-t-4 border-orange-600 mt-8">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-6 flex items-center justify-center gap-2">
                            <i data-lucide="megaphone" class="w-6 h-6"></i> üì¢ Latest Announcements
                        </h2>
                        <div id="studentAnnouncementsContainer" class="space-y-4">
                            <!-- Announcements will be loaded here -->
                        </div>
                    </div>

                    <!-- Quick Links Card -->
                    <div class="bg-white rounded-2xl shadow-xl p-8 border-t-4 border-orange-600 mt-8">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-6 flex items-center justify-center gap-2">
                            <i data-lucide="link" class="w-6 h-6"></i> Quick Actions
                        </h2>
                        <div class="space-y-3">
                            <button onclick="switchStudentTab('takeExam')" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 rounded-lg transition">üìù Take Exam</button>
                            <button onclick="switchStudentTab('results')" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg transition">üìä My Results</button>
                            <button onclick="switchStudentTab('courseNotes')" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition">üìö Course Notes</button>
                            <button onclick="switchStudentTab('courseVideos')" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-lg transition">üé• Video Lectures</button>
                            <button onclick="switchStudentTab('editProfile')" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg transition">‚úèÔ∏è Edit Profile</button>
                        </div>
                    </div>

                    <!-- Course Notes Tab -->
                    <div id="studentCourseNotes" class="hidden bg-white rounded-2xl shadow-xl p-8 mt-8">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center flex items-center justify-center gap-2">
                            <i data-lucide="book-open" class="w-6 h-6"></i> üìö Course Study Materials
                        </h2>
                        <div class="bg-blue-50 p-4 rounded-lg mb-6 border-l-4 border-blue-600">
                            <p class="text-sm text-blue-900"><strong>üìñ Course:</strong> <span id="courseNotesTitle" class="font-bold text-blue-700"></span></p>
                            <p class="text-xs text-blue-700 mt-2">Below are all the study materials and notes uploaded by instructors for your course. Click to download or view.</p>
                        </div>
                        <div id="courseNotesContainer" class="space-y-4">
                            <!-- Course notes uploaded by admin will be loaded here -->
                        </div>
                        <button onclick="switchStudentTab('profile')" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 rounded-lg transition mt-6">‚Üê Back to Dashboard</button>
                    </div>

                    <!-- Course Videos Tab -->
                    <div id="studentCourseVideos" class="hidden bg-white rounded-2xl shadow-xl p-8 mt-8">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center flex items-center justify-center gap-2">
                            <i data-lucide="play-circle" class="w-6 h-6"></i> üé• Course Video Lectures
                        </h2>
                        <div class="bg-red-50 p-4 rounded-lg mb-6 border-l-4 border-red-600">
                            <p class="text-sm text-red-900"><strong>üé¨ Course:</strong> <span id="courseVideosTitle" class="font-bold text-red-700"></span></p>
                            <p class="text-xs text-red-700 mt-2">Below are all the video lectures uploaded by instructors for your course. Click to watch or open in full screen.</p>
                        </div>
                        <div id="courseVideosContainer" class="space-y-6">
                            <!-- Course videos uploaded by admin will be loaded here -->
                        </div>
                        <button onclick="switchStudentTab('profile')" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 rounded-lg transition mt-6">‚Üê Back to Dashboard</button>
                    </div>

                    <!-- Edit Profile Tab -->
                    <div id="studentEditProfile" class="hidden bg-white rounded-2xl shadow-xl p-8 mt-8">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center">‚úèÔ∏è Edit Your Profile</h2>
                        <form id="editProfileForm" onsubmit="saveProfileChanges(event)" class="space-y-4">
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Full Name *</label>
                                    <input type="text" id="editName" class="input-field" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Email Address *</label>
                                    <input type="email" id="editEmail" class="input-field" required>
                                </div>
                            </div>

                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Mobile Number *</label>
                                    <input type="tel" id="editPhone" class="input-field" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Course</label>
                                    <input type="text" id="editCourse" class="input-field" disabled>
                                </div>
                            </div>

                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Enrollment Date</label>
                                    <input type="date" id="editEnrollDate" class="input-field" disabled>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Admission ID</label>
                                    <input type="text" id="editAdmissionNo" class="input-field" disabled>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Address (Optional)</label>
                                <textarea id="editAddress" placeholder="Enter your address" class="input-field h-20"></textarea>
                            </div>

                            <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                                <p class="text-xs text-gray-700"><strong>Note:</strong> Course, Enrollment Date, and Admission ID cannot be changed. Contact Admin for modifications.</p>
                            </div>

                            <div class="flex gap-4 pt-4">
                                <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg transition">‚úÖ Save Changes</button>
                                <button type="button" onclick="switchStudentTab('profile')" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 rounded-lg transition">‚ùå Cancel</button>
                            </div>
                        </form>
                    </div>

                    <!-- Exams Tab -->
                    <div id="studentTakeExam" class="hidden bg-white rounded-2xl shadow-xl p-8 mt-8">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center">üìù Available Exams</h2>
                        <div id="studentAvailableExamsContainer" class="space-y-4">
                            <!-- Available exams will be listed here -->
                        </div>
                    </div>

                    <!-- Exam Taking Interface -->
                    <div id="studentExamInterface" class="hidden bg-white rounded-2xl shadow-xl p-8 mt-8">
                        <div class="flex justify-between items-center mb-6">
                            <h2 id="studentExamTitle" class="text-2xl font-bold text-indigo-900"></h2>
                            <div class="bg-red-100 text-red-900 px-4 py-2 rounded-lg font-bold">
                                ‚è±Ô∏è Time Left: <span id="studentTimerDisplay">00:00</span>
                            </div>
                        </div>
                        <div class="bg-gray-100 p-4 rounded-lg mb-6">
                            <p class="text-gray-700"><strong>Total Questions:</strong> <span id="studentTotalQuestionsDisplay">0</span></p>
                            <p class="text-gray-700"><strong>Total Marks:</strong> <span id="studentExamMarksDisplay">0</span></p>
                        </div>

                        <div id="studentQuestionsDisplay" class="space-y-6 mb-8">
                            <!-- Questions will be displayed here -->
                        </div>

                        <div class="flex gap-4 justify-center">
                            <button onclick="submitStudentExam()" class="bg-green-600 hover:bg-green-700 text-white font-bold px-8 py-3 rounded-lg transition">‚úÖ Submit Exam</button>
                            <button onclick="exitStudentExam()" class="bg-red-600 hover:bg-red-700 text-white font-bold px-8 py-3 rounded-lg transition">‚ùå Exit Exam</button>
                        </div>
                    </div>

                    <!-- Results Tab -->
                    <div id="studentResults" class="hidden bg-white rounded-2xl shadow-xl p-8 mt-8">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center">üìä My Exam Results</h2>
                        <div id="studentResultsContainer" class="space-y-4">
                            <!-- Results will be displayed here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ============== ADMIN PANEL SECTION ============== -->
    <div id="admin" class="section">
        <div class="container mx-auto py-8 px-4">
            <!-- Admin Login Section -->
            <div id="adminLoginSection" class="max-w-md mx-auto bg-white rounded-2xl shadow-2xl p-8 mb-8">
                <h1 class="text-3xl font-bold text-center text-indigo-900 mb-6">Admin Login</h1>
                <div class="space-y-4">
                    <input type="text" id="adminUsername" placeholder="Admin Username" class="input-field" value="admin">
                    <input type="password" id="adminPassword" placeholder="Admin Password" class="input-field" value="admin123">
                    <button onclick="loginAdmin()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 rounded-lg transition">Login</button>
                    <p class="text-center text-gray-600 text-sm"> BE STRONG</strong></p>
                </div>
            </div>

            <!-- Main Admin Panel (Hidden by default) -->
            <div id="adminPanelSection" class="hidden">
                <!-- Tabs -->
                <div class="flex gap-4 mb-8 flex-wrap justify-center">
                    <button onclick="switchAdminTab('addStudent')" class="tab-btn bg-indigo-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-indigo-700 transition">‚ûï Add Student</button>
                    <button onclick="switchAdminTab('viewStudents')" class="tab-btn bg-blue-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-700 transition">üë• View Students</button>
                    <button onclick="switchAdminTab('generateCredentials')" class="tab-btn bg-green-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-green-700 transition">üîë Generate Credentials</button>
                    <button onclick="switchAdminTab('feeManagement')" class="tab-btn bg-red-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-red-700 transition">üí∞ Fee Management</button>
                    <button onclick="switchAdminTab('createExam')" class="tab-btn bg-yellow-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-yellow-700 transition">üìù Create Exam</button>
                    <button onclick="switchAdminTab('viewExams')" class="tab-btn bg-purple-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-purple-700 transition">üìä View Exams</button>
                    <button onclick="switchAdminTab('announcements')" class="tab-btn bg-orange-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-orange-700 transition">üì¢ Announcements</button>
                    <button onclick="switchAdminTab('uploadNotes')" class="tab-btn bg-cyan-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-cyan-700 transition">üìö Upload Notes</button>
                    <button onclick="switchAdminTab('uploadVideos')" class="tab-btn bg-red-500 text-white px-6 py-2 rounded-lg font-bold hover:bg-red-600 transition">üé• Upload Videos</button>
                    <button onclick="logoutAdmin()" class="bg-red-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-red-700">Logout</button>
                </div>

                <!-- Add Student Tab -->
                <div id="addStudent" class="admin-tab-content max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-8 mb-8">
                    <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center">Add New Student</h2>
                    <div class="space-y-4">
                        <input type="text" id="studentName" placeholder="Full Name" class="input-field">
                        <input type="email" id="studentEmail" placeholder="Email Address" class="input-field">
                        <input type="tel" id="studentPhone" placeholder="Mobile Number" class="input-field">
                        <select id="studentCourse" class="input-field">
                            <option value="">Select Course</option>
                            <option value="CCC">CCC Course</option>
                            <option value="ADCA">ADCA</option>
                            <option value="DCA">DCA</option>
                            <option value="BCA">BCA</option>
                            <option value="Python">Python</option>
                            <option value="Java">Java</option>
                            <option value="Tally">Tally</option>
                        </select>
                        <input type="date" id="studentEnrollDate" placeholder="Enrollment Date" class="input-field">
                        <input type="text" id="studentFees" placeholder="Total Fees" class="input-field">
                        <button onclick="addNewStudent()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 rounded-lg transition">Add Student</button>
                    </div>
                </div>

                <!-- View Students Tab -->
                <div id="viewStudents" class="admin-tab-content max-w-7xl mx-auto bg-white rounded-2xl shadow-2xl p-8 mb-8 hidden">
                    <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center">üìä Students Database (Fully Editable)</h2>
                    <input type="text" id="searchStudent" onkeyup="searchStudents()" placeholder="Search by name, email, or ID..." class="input-field mb-6">
                    
                    <!-- List View -->
                    <div id="studentListView" class="grid grid-cols-1 gap-6">
                        <!-- Student cards will be displayed here -->
                    </div>
                </div>

                <!-- Student Edit Modal (Hidden by default) -->
                <div id="studentEditModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto">
                    <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-3xl w-full my-8">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-indigo-900">‚úèÔ∏è Edit Student Details</h2>
                            <button onclick="closeStudentEditModal()" class="text-gray-600 hover:text-red-600 text-2xl font-bold">√ó</button>
                        </div>

                        <form id="studentEditForm" onsubmit="saveStudentChanges(event)" class="space-y-4">
                            <input type="hidden" id="editStudentId">

                            <div class="grid md:grid-cols-3 gap-4 mb-6">
                                <!-- Photo Upload Section -->
                                <div class="md:col-span-1">
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Student Photo</label>
                                    <div id="editPhotoPreview" class="border-2 border-dashed border-indigo-400 rounded-lg p-4 text-center mb-4">
                                        <img id="editPhotoImg" src="" alt="Student Photo" class="h-40 w-32 object-cover mx-auto rounded-lg hidden">
                                        <p id="editNoPhoto" class="text-gray-400">No Photo</p>
                                    </div>
                                    <div class="flex flex-col items-center justify-center border-2 border-dashed border-indigo-400 rounded-lg p-4 bg-indigo-50 cursor-pointer hover:border-indigo-600" onclick="document.getElementById('editPhotoUpload').click()">
                                        <i data-lucide="upload-cloud" class="w-8 h-8 text-indigo-600 mb-2"></i>
                                        <p class="text-xs font-bold text-gray-700 text-center">Click to upload photo</p>
                                        <input type="file" id="editPhotoUpload" accept="image/*" class="hidden" onchange="handleEditPhotoUpload(event)">
                                    </div>
                                </div>

                                <!-- Personal Details -->
                                <div class="md:col-span-2 space-y-4">
                                    <div>
                                        <label class="block text-sm font-bold text-gray-700 mb-2">Full Name *</label>
                                        <input type="text" id="editStudentName" class="input-field" required>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-bold text-gray-700 mb-2">Email Address *</label>
                                        <input type="email" id="editStudentEmail" class="input-field" required>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-bold text-gray-700 mb-2">Mobile Number *</label>
                                        <input type="tel" id="editStudentPhone" class="input-field" required>
                                    </div>
                                </div>
                            </div>

                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Course *</label>
                                    <select id="editStudentCourse" class="input-field" required>
                                        <option value="">-- Select Course --</option>
                                        <option value="CCC">CCC Course</option>
                                        <option value="ADCA">ADCA (Advanced Diploma)</option>
                                        <option value="DCA">DCA (Diploma)</option>
                                        <option value="BCA">BCA (Bachelor)</option>
                                        <option value="Python">Python Programming</option>
                                        <option value="Java">Java Programming</option>
                                        <option value="Tally">Tally ERP</option>
                                        <option value="O-Level">O-Level</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Status</label>
                                    <select id="editStudentStatus" class="input-field">
                                        <option value="Active">Active</option>
                                        <option value="Inactive">Inactive</option>
                                        <option value="Suspended">Suspended</option>
                                    </select>
                                </div>
                            </div>

                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Enrollment Date</label>
                                    <input type="date" id="editStudentEnrollDate" class="input-field">
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Total Fees</label>
                                    <input type="number" id="editStudentFees" class="input-field" placeholder="e.g., 5000">
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Address</label>
                                <textarea id="editStudentAddress" placeholder="Enter complete address" class="input-field h-20"></textarea>
                            </div>

                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Admission ID (Read-only)</label>
                                    <input type="text" id="editStudentAdmissionNo" class="input-field bg-gray-100" disabled>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Password</label>
                                    <input type="text" id="editStudentPassword" class="input-field">
                                </div>
                            </div>

                            <div class="flex gap-4 pt-4">
                                <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg transition">‚úÖ Save Changes</button>
                                <button type="button" onclick="closeStudentEditModal()" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 rounded-lg transition">‚ùå Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Generate Credentials Tab -->
                <div id="generateCredentials" class="admin-tab-content max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-8 mb-8 hidden">
                    <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center">Generate Student Credentials</h2>
                    <div class="space-y-4">
                        <select id="credentialStudent" class="input-field">
                            <option value="">Select Student</option>
                        </select>
                        <div class="bg-gray-100 p-4 rounded-lg">
                            <p class="text-sm text-gray-600 mb-2"><strong>Admission ID:</strong></p>
                            <input type="text" id="admissionID" readonly class="input-field bg-gray-50">
                        </div>
                        <div class="bg-gray-100 p-4 rounded-lg">
                            <p class="text-sm text-gray-600 mb-2"><strong>Password:</strong></p>
                            <div class="flex gap-2">
                                <input type="text" id="studentPasswordField" readonly class="input-field bg-gray-50">
                                <button onclick="generatePassword()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-bold">Generate</button>
                            </div>
                        </div>
                        <button onclick="sendCredentialsToStudent()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 rounded-lg transition">Send Credentials</button>
                    </div>
                </div>

                <!-- Create Exam Tab -->
                <div id="createExam" class="admin-tab-content max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl p-8 mb-8 hidden">
                    <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center">üìù Create New Exam</h2>
                    <div class="space-y-4">
                        <div class="grid md:grid-cols-2 gap-4">
                            <input type="text" id="examTitle" placeholder="Exam Title (e.g., CCC Chapter 1 Test)" class="input-field">
                            <select id="examCourse" class="input-field">
                                <option value="">Select Course</option>
                                <option value="CCC">CCC Course</option>
                                <option value="ADCA">ADCA</option>
                                <option value="DCA">DCA</option>
                                <option value="BCA">BCA</option>
                                <option value="Python">Python</option>
                                <option value="Java">Java</option>
                                <option value="Tally">Tally</option>
                            </select>
                        </div>
                        <textarea id="examDescription" placeholder="Exam Description" class="input-field h-20"></textarea>
                        <div class="grid md:grid-cols-3 gap-4">
                            <input type="number" id="examTotalMarks" placeholder="Total Marks" class="input-field" value="100">
                            <input type="number" id="examPassMarks" placeholder="Pass Marks" class="input-field" value="40">
                            <input type="number" id="examDuration" placeholder="Duration (minutes)" class="input-field" value="30">
                        </div>

                        <div class="border-t-2 pt-6 mt-6">
                            <h3 class="text-xl font-bold text-indigo-900 mb-4">üìå Add Questions</h3>
                            
                            <div id="questionsContainer" class="space-y-6 mb-6">
                                <!-- Questions will be added here dynamically -->
                            </div>

                            <button onclick="addQuestionField()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 rounded-lg transition mb-6">+ Add Question</button>
                        </div>

                        <div class="flex gap-4">
                            <button onclick="saveExam()" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg transition">‚úÖ Save Exam</button>
                            <button onclick="resetExamForm()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 rounded-lg transition">üîÑ Reset</button>
                        </div>
                    </div>
                </div>

                <!-- Fee Management Tab -->
                <div id="feeManagement" class="admin-tab-content max-w-6xl mx-auto bg-white rounded-2xl shadow-2xl p-8 mb-8 hidden">
                    <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center">üí∞ Fee Management System</h2>
                    
                    <!-- Fee Summary Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                        <div class="bg-blue-100 p-6 rounded-lg text-center">
                            <p class="text-gray-600 text-sm font-bold">Total Students</p>
                            <p class="text-3xl font-bold text-blue-900" id="totalStudentsCount">0</p>
                        </div>
                        <div class="bg-green-100 p-6 rounded-lg text-center">
                            <p class="text-gray-600 text-sm font-bold">Total Fees Collected</p>
                            <p class="text-3xl font-bold text-green-900" id="totalCollected">‚Çπ0</p>
                        </div>
                        <div class="bg-yellow-100 p-6 rounded-lg text-center">
                            <p class="text-gray-600 text-sm font-bold">Pending Fees</p>
                            <p class="text-3xl font-bold text-yellow-900" id="totalPending">‚Çπ0</p>
                        </div>
                        <div class="bg-red-100 p-6 rounded-lg text-center">
                            <p class="text-gray-600 text-sm font-bold">Overdue Students</p>
                            <p class="text-3xl font-bold text-red-900" id="overdueCount">0</p>
                        </div>
                    </div>

                    <!-- Tabs for Fee Management -->
                    <div class="flex gap-2 mb-6 flex-wrap">
                        <button onclick="switchFeeTab('studentFees')" class="fee-tab-btn bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-indigo-700 transition">View Student Fees</button>
                        <button onclick="switchFeeTab('collectFee')" class="fee-tab-btn bg-green-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-green-700 transition">Collect Fee</button>
                        <button onclick="switchFeeTab('feeReport')" class="fee-tab-btn bg-purple-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-purple-700 transition">Fee Report</button>
                    </div>

                    <!-- View Student Fees -->
                    <div id="studentFees" class="fee-tab-content">
                        <input type="text" id="searchFeeStudent" onkeyup="searchFeeStudents()" placeholder="Search by name, email, or admission no..." class="input-field mb-6">
                        <div class="overflow-x-auto">
                            <table class="w-full border-collapse">
                                <thead class="bg-indigo-900 text-white">
                                    <tr>
                                        <th class="border p-3 text-left">Student Name</th>
                                        <th class="border p-3 text-left">Admission No.</th>
                                        <th class="border p-3 text-left">Course</th>
                                        <th class="border p-3 text-right">Total Fees</th>
                                        <th class="border p-3 text-right">Paid Amount</th>
                                        <th class="border p-3 text-right">Pending Amount</th>
                                        <th class="border p-3 text-center">Status</th>
                                        <th class="border p-3 text-center">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="studentFeesTable">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Collect Fee -->
                    <div id="collectFee" class="fee-tab-content hidden max-w-2xl">
                        <h3 class="text-xl font-bold text-indigo-900 mb-4">Collect Fee from Student</h3>
                        <div class="space-y-4">
                            <select id="feeStudent" class="input-field" onchange="loadStudentFeeDetails()">
                                <option value="">Select Student</option>
                            </select>
                            <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-indigo-600">
                                <div class="grid grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <p class="text-sm text-gray-600">Total Fees</p>
                                        <p class="text-2xl font-bold text-indigo-900" id="displayTotalFees">‚Çπ0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-600">Already Paid</p>
                                        <p class="text-2xl font-bold text-green-900" id="displayPaidAmount">‚Çπ0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-600">Pending</p>
                                        <p class="text-2xl font-bold text-red-900" id="displayPendingAmount">‚Çπ0</p>
                                    </div>
                                </div>
                            </div>
                            <input type="number" id="feeAmount" placeholder="Amount to Collect (‚Çπ)" class="input-field" min="0">
                            <select id="feePaymentMode" class="input-field">
                                <option value="">Select Payment Mode</option>
                                <option value="Cash">Cash</option>
                                <option value="UPI">UPI</option>
                                <option value="Cheque">Cheque</option>
                                <option value="Bank Transfer">Bank Transfer</option>
                                <option value="Card">Card</option>
                            </select>
                            <input type="date" id="feePaymentDate" class="input-field">
                            <textarea id="feeNotes" placeholder="Payment Notes (Optional)" class="input-field h-20"></textarea>
                            <button onclick="collectStudentFee()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg transition">‚úÖ Record Payment</button>
                        </div>
                    </div>

                    <!-- Fee Report -->
                    <div id="feeReport" class="fee-tab-content hidden">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <select id="reportCourse" class="input-field" onchange="generateFeeReport()">
                                <option value="">All Courses</option>
                                <option value="CCC">CCC Course</option>
                                <option value="ADCA">ADCA</option>
                                <option value="DCA">DCA</option>
                                <option value="BCA">BCA</option>
                                <option value="Python">Python</option>
                                <option value="Java">Java</option>
                                <option value="Tally">Tally</option>
                            </select>
                            <select id="reportStatus" class="input-field" onchange="generateFeeReport()">
                                <option value="">All Status</option>
                                <option value="Paid">Paid</option>
                                <option value="Partial">Partial</option>
                                <option value="Pending">Pending</option>
                            </select>
                            <button onclick="downloadFeeReport()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-bold">üì• Download Report</button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full border-collapse">
                                <thead class="bg-indigo-900 text-white">
                                    <tr>
                                        <th class="border p-3 text-left">Student Name</th>
                                        <th class="border p-3 text-left">Course</th>
                                        <th class="border p-3 text-right">Total Fees</th>
                                        <th class="border p-3 text-right">Paid</th>
                                        <th class="border p-3 text-right">Pending</th>
                                        <th class="border p-3 text-center">% Paid</th>
                                        <th class="border p-3 text-center">Status</th>
                                    </tr>
                                </thead>
                                <tbody id="feeReportTable">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- View Exams Tab -->
                <div id="viewExams" class="admin-tab-content max-w-6xl mx-auto bg-white rounded-2xl shadow-2xl p-8 mb-8 hidden">
                    <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center">üìä All Exams</h2>
                    <input type="text" id="searchExam" onkeyup="searchExams()" placeholder="Search by exam title or course..." class="input-field mb-6">
                    <div id="examsListContainer" class="space-y-4">
                        <!-- Exams will be listed here -->
                    </div>
                </div>

                <!-- Announcements Tab -->
                <div id="announcements" class="admin-tab-content max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl p-8 mb-8 hidden">
                    <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center">üì¢ Student Announcements</h2>
                    
                    <!-- Create Announcement Section -->
                    <div class="bg-gradient-to-r from-orange-100 to-yellow-100 rounded-lg p-6 mb-8 border-l-4 border-orange-600">
                        <h3 class="text-xl font-bold text-orange-900 mb-4">üìù Create New Announcement</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Announcement Title *</label>
                                <input type="text" id="announcementTitle" placeholder="e.g., Holiday Notice, Class Timing Change" class="input-field" required>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Message/Notice *</label>
                                <textarea id="announcementMessage" placeholder="Type your announcement here..." class="input-field h-24" required></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Priority Level</label>
                                <select id="announcementPriority" class="input-field">
                                    <option value="Normal">Normal</option>
                                    <option value="Important">Important</option>
                                    <option value="Urgent">Urgent</option>
                                </select>
                            </div>
                            <button onclick="createAnnouncement()" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 rounded-lg transition">üì§ Post Announcement</button>
                        </div>
                    </div>

                    <!-- Announcements List -->
                    <h3 class="text-xl font-bold text-indigo-900 mb-4">üìã All Announcements</h3>
                    <div id="announcementsList" class="space-y-4">
                        <!-- Announcements will be displayed here -->
                    </div>
                </div>

                <!-- Upload Notes Tab -->
                <div id="uploadNotes" class="admin-tab-content max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl p-8 mb-8 hidden">
                    <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center">üìö Upload Course Notes</h2>
                    
                    <!-- Upload Notes Form -->
                    <div class="bg-gradient-to-r from-cyan-100 to-blue-100 rounded-lg p-6 mb-8 border-l-4 border-cyan-600">
                        <h3 class="text-xl font-bold text-cyan-900 mb-4">üìù Add New Study Notes</h3>
                        <div class="space-y-4">
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Select Course *</label>
                                    <select id="notesUploadCourse" class="input-field" required>
                                        <option value="">-- Select Course --</option>
                                        <option value="CCC">CCC Course</option>
                                        <option value="ADCA">ADCA (Advanced Diploma)</option>
                                        <option value="DCA">DCA (Diploma)</option>
                                        <option value="BCA">BCA (Bachelor)</option>
                                        <option value="Python">Python Programming</option>
                                        <option value="Java">Java Programming</option>
                                        <option value="Tally">Tally ERP</option>
                                        <option value="O-Level">O-Level</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Notes Title *</label>
                                    <input type="text" id="notesTitle" placeholder="e.g., Chapter 1: Introduction" class="input-field" required>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Notes Description</label>
                                <textarea id="notesDescription" placeholder="Add description, topics covered, etc..." class="input-field h-20"></textarea>
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">üìÑ Upload PDF/Document *</label>
                                <div class="flex flex-col items-center justify-center border-2 border-dashed border-cyan-400 rounded-lg p-6 bg-cyan-50 cursor-pointer hover:border-cyan-600 hover:bg-cyan-100 transition" onclick="document.getElementById('notesFileUpload').click()">
                                    <i data-lucide="upload-cloud" class="w-12 h-12 text-cyan-600 mb-2"></i>
                                    <p class="text-sm font-bold text-gray-700 text-center">Click to upload or drag and drop</p>
                                    <p class="text-xs text-gray-600 text-center mt-1">PDF, DOC, DOCX, TXT (Max 10MB)</p>
                                    <input type="file" id="notesFileUpload" accept=".pdf,.doc,.docx,.txt,.pptx" class="hidden" onchange="handleNotesFileUpload(event)">
                                </div>
                                <div id="notesFilePreview" class="mt-4 hidden">
                                    <p class="text-sm font-bold text-gray-700 mb-2">üìé Selected File:</p>
                                    <div id="notesFileInfo" class="flex items-center gap-2 p-3 bg-cyan-50 border border-cyan-300 rounded-lg">
                                        <i data-lucide="file" class="w-5 h-5 text-cyan-600"></i>
                                        <span id="notesFileName" class="text-sm font-bold text-gray-700"></span>
                                    </div>
                                    <button type="button" onclick="clearNotesFile()" class="mt-2 text-xs text-red-600 hover:underline font-bold">Remove File</button>
                                </div>
                            </div>

                            <button onclick="uploadNotes()" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 rounded-lg transition">üì§ Upload Notes</button>
                        </div>
                    </div>

                    <!-- Uploaded Notes List -->
                    <h3 class="text-xl font-bold text-indigo-900 mb-4">üìã All Uploaded Notes</h3>
                    <div id="allNotesList" class="space-y-4">
                        <!-- Notes will be displayed here -->
                    </div>
                </div>

                <!-- Upload Videos Tab -->
                <div id="uploadVideos" class="admin-tab-content max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl p-8 mb-8 hidden">
                    <h2 class="text-2xl font-bold text-indigo-900 mb-6 text-center">üé• Upload Course Videos</h2>
                    
                    <!-- Upload Videos Form -->
                    <div class="bg-gradient-to-r from-red-100 to-pink-100 rounded-lg p-6 mb-8 border-l-4 border-red-600">
                        <h3 class="text-xl font-bold text-red-900 mb-4">üìπ Add New YouTube Video</h3>
                        <div class="space-y-4">
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Select Course *</label>
                                    <select id="videoUploadCourse" class="input-field" required>
                                        <option value="">-- Select Course --</option>
                                        <option value="CCC">CCC Course</option>
                                        <option value="ADCA">ADCA (Advanced Diploma)</option>
                                        <option value="DCA">DCA (Diploma)</option>
                                        <option value="BCA">BCA (Bachelor)</option>
                                        <option value="Python">Python Programming</option>
                                        <option value="Java">Java Programming</option>
                                        <option value="Tally">Tally ERP</option>
                                        <option value="O-Level">O-Level</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Video Title *</label>
                                    <input type="text" id="videoTitle" placeholder="e.g., Introduction to Python" class="input-field" required>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">YouTube Video URL *</label>
                                <input type="url" id="videoURL" placeholder="e.g., https://www.youtube.com/watch?v=..." class="input-field" required>
                                <p class="text-xs text-gray-600 mt-1">üí° Paste the full YouTube video URL or just the video ID</p>
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Video Description</label>
                                <textarea id="videoDescription" placeholder="Add description, topics covered, duration, etc..." class="input-field h-20"></textarea>
                            </div>

                            <button onclick="uploadVideo()" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-lg transition">üì§ Upload Video</button>
                        </div>
                    </div>

                    <!-- Uploaded Videos List -->
                    <h3 class="text-xl font-bold text-indigo-900 mb-4">üé¨ All Uploaded Videos</h3>
                    <div id="allVideosList" class="space-y-4">
                        <!-- Videos will be displayed here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // ============== NAVIGATION ============== 
        function switchSection(section) {
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            document.getElementById(section).classList.add('active');
            window.scrollTo(0, 0);
        }

        function searchNotes() {
            let input = document.getElementById('noteSearch').value.toLowerCase();
            let cards = document.getElementsByClassName('hover-scale');
            for (let i = 0; i < cards.length; i++) {
                let text = cards[i].innerText.toLowerCase();
                cards[i].style.display = text.includes(input) ? "" : "none";
            }
        }

        // ============== STUDENT PORTAL ============== 
        const students = JSON.parse(localStorage.getItem('aactiStudents')) || [
            { id: 1, name: "Aman Kumar", email: "aman@email.com", phone: "9876543210", course: "CCC", enrollDate: "2026-01-01", fees: "5000", admissionNo: "AACTI/2026/001", password: "Pass@123", status: "Active", address: "" },
            { id: 2, name: "Priya Singh", email: "priya@email.com", phone: "9876543211", course: "ADCA", enrollDate: "2026-01-02", fees: "10000", admissionNo: "AACTI/2026/002", password: "Pass@234", status: "Active", address: "" }
        ];
        let currentStudent = null;

        function studentLogin() {
            const email = document.getElementById('studentEmail').value.trim();
            const password = document.getElementById('studentPassword').value.trim();

            if (!email || !password) {
                alert('‚ùå Please enter both GMAIL and Password');
                return;
            }

            const student = students.find(s => s.email === email && s.password === password);
            
            if (student) {
                currentStudent = student;
                localStorage.setItem('currentStudent', JSON.stringify(student));
                document.getElementById('studentLoginSection').classList.add('hidden');
                document.getElementById('studentDashboardSection').classList.remove('hidden');
                loadStudentDashboard();
                loadStudentCourseNotes(student.course);
            } else {
                alert('‚ùå Invalid GMAIL or Password. Try: aman@gmail.com / Pass@123');
            }
        }

        function togglePasswordVisibility() {
            const input = document.getElementById('studentPassword');
            if (input.type === 'password') {
                input.type = 'text';
            } else {
                input.type = 'password';
            }
        }

        function loadStudentDashboard() {
            if (!currentStudent) return;
            document.getElementById('studentNameDisplay').textContent = currentStudent.name;
            document.getElementById('displayName').textContent = currentStudent.name;
            document.getElementById('displayEmail').textContent = currentStudent.email;
            document.getElementById('displayCourse').textContent = currentStudent.course;
            document.getElementById('displayAdmissionNo').textContent = currentStudent.admissionNo;
            document.getElementById('displayStatus').textContent = currentStudent.status;
            document.getElementById('totalFees').textContent = '‚Çπ' + currentStudent.fees;
            loadStudentAnnouncements();
        }

        function loadStudentAnnouncements() {
            const container = document.getElementById('studentAnnouncementsContainer');
            const allAnnouncements = JSON.parse(localStorage.getItem('aactiAnnouncements')) || [];

            if (allAnnouncements.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-600 py-8">No announcements at this time.</p>';
                return;
            }

            container.innerHTML = allAnnouncements.slice(0, 5).map(announcement => {
                const priorityColor = 
                    announcement.priority === 'Urgent' ? 'bg-red-100 border-red-300 text-red-900' :
                    announcement.priority === 'Important' ? 'bg-yellow-100 border-yellow-300 text-yellow-900' :
                    'bg-blue-100 border-blue-300 text-blue-900';

                return `
                    <div class="border-l-4 ${priorityColor} bg-opacity-50 border-l-orange-500 rounded-lg p-4">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="text-lg font-bold text-indigo-900">${announcement.title}</h4>
                                <p class="text-sm text-gray-600 mt-1">${announcement.message}</p>
                                <p class="text-xs text-gray-500 mt-2">üìÖ ${announcement.date} at ${announcement.time}</p>
                            </div>
                            <span class="px-3 py-1 rounded-full text-xs font-bold bg-white ${priorityColor}">${announcement.priority}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function studentLogout() {
            if (confirm('Are you sure you want to logout?')) {
                currentStudent = null;
                localStorage.removeItem('currentStudent');
                document.getElementById('studentLoginSection').classList.remove('hidden');
                document.getElementById('studentDashboardSection').classList.add('hidden');
                document.getElementById('studentEmail').value = '';
                document.getElementById('studentPassword').value = '';
            }
        }

        // ============== STUDENT PORTAL TAB SWITCHING ==============
        function switchStudentPortalTab(tab) {
            // Hide all tabs
            document.querySelectorAll('.student-portal-tab-content').forEach(el => el.classList.add('hidden'));
            
            // Show selected tab
            if (tab === 'login') {
                document.getElementById('studentLoginSection').classList.remove('hidden');
            } else if (tab === 'admission') {
                document.getElementById('studentAdmissionSection').classList.remove('hidden');
            }
        }

        // ============== STUDENT PROFILE EDIT FUNCTIONS ==============
        function loadEditProfileForm() {
            if (!currentStudent) return;
            
            document.getElementById('editName').value = currentStudent.name;
            document.getElementById('editEmail').value = currentStudent.email;
            document.getElementById('editPhone').value = currentStudent.phone;
            document.getElementById('editCourse').value = currentStudent.course;
            document.getElementById('editEnrollDate').value = currentStudent.enrollDate;
            document.getElementById('editAdmissionNo').value = currentStudent.admissionNo;
            document.getElementById('editAddress').value = currentStudent.address || '';
        }

        function saveProfileChanges(event) {
            event.preventDefault();

            if (!currentStudent) return;

            const name = document.getElementById('editName').value.trim();
            const email = document.getElementById('editEmail').value.trim();
            const phone = document.getElementById('editPhone').value.trim();
            const address = document.getElementById('editAddress').value.trim();

            if (!name || !email || !phone) {
                alert('‚ùå Please fill in all required fields');
                return;
            }

            // Validate email format
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('‚ùå Please enter a valid email address');
                return;
            }

            // Validate phone number (10 digits)
            const phoneRegex = /^[0-9]{10}$/;
            if (!phoneRegex.test(phone)) {
                alert('‚ùå Please enter a valid 10-digit phone number');
                return;
            }

            // Update currentStudent object
            currentStudent.name = name;
            currentStudent.email = email;
            currentStudent.phone = phone;
            currentStudent.address = address;

            // Update in students array
            const studentIndex = students.findIndex(s => s.admissionNo === currentStudent.admissionNo);
            if (studentIndex !== -1) {
                students[studentIndex] = currentStudent;
            }

            // Save to localStorage
            localStorage.setItem('aactiStudents', JSON.stringify(students));
            localStorage.setItem('currentStudent', JSON.stringify(currentStudent));

            // Reload dashboard to show updated info
            loadStudentDashboard();
            alert('‚úÖ Profile updated successfully!');
            
            // Hide edit form and show dashboard
            document.getElementById('studentEditProfile').classList.add('hidden');
        }

        // ============== PDF DOWNLOAD FUNCTION ==============
        // ============== STUDENT DOWNLOAD FUNCTIONS ==============
        function downloadStudentIDCardForStudent() {
            if (!currentStudent) {
                alert('‚ùå Please login first');
                return;
            }

            const student = currentStudent;
            const element = document.createElement('div');
            element.innerHTML = `
                <div style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; width: 100%; padding: 10px; background: white;">
                    <div style="max-width: 450px; margin: 0 auto;">
                        <!-- FRONT SIDE -->
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%); color: white; padding: 20px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); min-height: 240px; position: relative; overflow: hidden; margin-bottom: 20px; display: flex; flex-direction: column; justify-content: space-between;">
                            <!-- Background Pattern -->
                            <div style="position: absolute; top: -30px; right: -30px; width: 150px; height: 150px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
                            <div style="position: absolute; bottom: -20px; left: -20px; width: 100px; height: 100px; background: rgba(255,255,255,0.05); border-radius: 50%;"></div>

                            <!-- Header -->
                            <div style="position: relative; z-index: 2; text-align: center; margin-bottom: 8px;">
                                <p style="margin: 0; font-size: 18px; font-weight: 900; letter-spacing: 0.5px;">AAYAT ACADEMY</p>
                                <p style="margin: 2px 0 0 0; font-size: 8px; opacity: 0.9; font-weight: 600;">üéì COMPUTER TRAINING INSTITUTE</p>
                                <div style="width: 40px; height: 2px; background: #fbbf24; margin: 6px auto;"></div>
                            </div>

                            <!-- Photo & Info Section -->
                            <div style="position: relative; z-index: 2; display: grid; grid-template-columns: 60px 1fr; gap: 10px; align-items: center; margin: 8px 0;">
                                <div style="text-align: center;">
                                    ${student.photo ? `<img src="${student.photo}" alt="Photo" style="width: 60px; height: 75px; object-fit: cover; border: 3px solid #fbbf24; border-radius: 4px; display: block;">` : '<div style="width: 60px; height: 75px; background: rgba(255,255,255,0.2); border: 2px dashed #fbbf24; border-radius: 4px; display: flex; align-items: center; justify-content: center;"><span style="font-size: 8px;">Photo</span></div>'}
                                </div>
                                <div>
                                    <p style="margin: 0 0 3px 0; font-size: 14px; font-weight: 900;">${student.name}</p>
                                    <p style="margin: 0 0 2px 0; font-size: 7px; opacity: 0.85;">Admission ID</p>
                                    <p style="margin: 0; font-size: 10px; font-family: monospace; font-weight: bold;">${student.admissionNo}</p>
                                </div>
                            </div>

                            <!-- Course Info -->
                            <div style="position: relative; z-index: 2; text-align: center; margin-top: 4px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.3);">
                                <p style="margin: 0; font-size: 8px; opacity: 0.9;">üìö Course</p>
                                <p style="margin: 2px 0 0 0; font-size: 9px; font-weight: 600;">${student.course}</p>
                            </div>
                        </div>

                        <!-- BACK SIDE -->
                        <div style="background: linear-gradient(135deg, #ffffff 0%, #f3f4f6 100%); color: #1f2937; padding: 16px; border-radius: 12px; border: 2px solid #667eea; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                            <!-- Header -->
                            <div style="text-align: center; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 2px solid #667eea;">
                                <p style="margin: 0; font-size: 10px; font-weight: 700; color: #667eea; letter-spacing: 0.5px;">STUDENT ID CARD</p>
                            </div>

                            <!-- Info Grid -->
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                <div style="background: linear-gradient(135deg, #e0e7ff 0%, #f0f4ff 100%); padding: 8px; border-radius: 6px; border-left: 3px solid #667eea;">
                                    <p style="margin: 0 0 2px 0; font-size: 7px; font-weight: 700; color: #667eea; text-transform: uppercase;">üìß Email</p>
                                    <p style="margin: 0; font-size: 8px; word-break: break-all; font-weight: 500;">${student.email}</p>
                                </div>

                                <div style="background: linear-gradient(135deg, #fce7f3 0%, #fdf2f8 100%); padding: 8px; border-radius: 6px; border-left: 3px solid #ec4899;">
                                    <p style="margin: 0 0 2px 0; font-size: 7px; font-weight: 700; color: #ec4899; text-transform: uppercase;">üì± Phone</p>
                                    <p style="margin: 0; font-size: 8px; font-weight: 500;">${student.phone || 'N/A'}</p>
                                </div>

                                <div style="background: linear-gradient(135deg, #dbeafe 0%, #eff6ff 100%); padding: 8px; border-radius: 6px; border-left: 3px solid #0284c7;">
                                    <p style="margin: 0 0 2px 0; font-size: 7px; font-weight: 700; color: #0284c7; text-transform: uppercase;">üìÖ Enrolled</p>
                                    <p style="margin: 0; font-size: 8px; font-weight: 500;">${student.enrollDate || 'N/A'}</p>
                                </div>

                                <div style="background: linear-gradient(135deg, #dcfce7 0%, #f0fdf4 100%); padding: 8px; border-radius: 6px; border-left: 3px solid #16a34a;">
                                    <p style="margin: 0 0 2px 0; font-size: 7px; font-weight: 700; color: #16a34a; text-transform: uppercase;">‚úÖ Status</p>
                                    <p style="margin: 0; font-size: 8px; font-weight: 600; color: ${student.status === 'Active' ? '#059669' : '#ca8a04'};">${student.status}</p>
                                </div>

                                <div style="background: linear-gradient(135deg, #fee2e2 0%, #fef2f2 100%); padding: 8px; border-radius: 6px; border-left: 3px solid #dc2626; grid-column: span 2;">
                                    <p style="margin: 0 0 2px 0; font-size: 7px; font-weight: 700; color: #dc2626; text-transform: uppercase;">üí∞ Course Fees</p>
                                    <p style="margin: 0; font-size: 9px; font-weight: bold; color: #dc2626;">‚Çπ${student.fees || '0'}</p>
                                </div>
                            </div>

                            <!-- Footer -->
                            <div style="text-align: center; margin-top: 10px; padding-top: 8px; border-top: 1px solid #e5e7eb;">
                                <p style="margin: 2px 0; font-size: 8px; font-weight: 600; color: #667eea;">AAYAT ACADEMY</p>
                                <p style="margin: 1px 0; font-size: 7px; color: #6b7280;">üìû 8181867118 ‚Ä¢ www.aacti.in</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            const options = {
                margin: 5,
                filename: student.admissionNo + '_StudentIDCard.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2.5 },
                jsPDF: { orientation: 'portrait', unit: 'mm', format: 'a4' }
            };

            html2pdf().set(options).from(element).save();
            alert('‚úÖ ID Card downloaded successfully!');
        }

        function downloadStudentAdmissionFormForStudent() {
            if (!currentStudent) {
                alert('‚ùå Please login first');
                return;
            }

            const student = currentStudent;
            const element = document.createElement('div');
            element.innerHTML = `
                <div style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 15px; max-width: 100%; color: #1f2937; background: white;">
                    <!-- Header Section -->
                    <div style="background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); color: white; padding: 20px; border-radius: 12px; text-align: center; margin-bottom: 15px;">
                        <p style="margin: 0 0 5px 0; font-size: 24px; font-weight: 900; letter-spacing: 1px;">AAYAT ACADEMY</p>
                        <p style="margin: 3px 0; font-size: 11px; opacity: 0.95;">üéì Computer Training Institute</p>
                        <h2 style="color: #fbbf24; margin: 8px 0 0 0; font-size: 16px; font-weight: bold;">Student Admission Form</h2>
                    </div>

                    <!-- Student Info Grid -->
                    <div style="display: grid; grid-template-columns: 80px 1fr; gap: 12px; margin-bottom: 15px; background: #f0f4ff; padding: 12px; border-radius: 8px; border-left: 4px solid #4f46e5;">
                        <div style="text-align: center;">
                            ${student.photo ? `<img src="${student.photo}" alt="Student Photo" style="width: 75px; height: 90px; object-fit: cover; border: 2px solid #4f46e5; border-radius: 4px;">` : '<div style="width: 75px; height: 90px; background: #e5e7eb; border: 2px dashed #4f46e5; border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #6b7280;">No Photo</div>'}
                        </div>
                        <div style="display: flex; flex-direction: column; justify-content: center;">
                            <h3 style="margin: 0 0 5px 0; color: #4f46e5; font-size: 16px; font-weight: bold;">${student.name}</h3>
                            <p style="margin: 2px 0; font-size: 10px;"><strong>Admission ID:</strong> <span style="font-family: monospace; color: #0891b2;">${student.admissionNo}</span></p>
                            <p style="margin: 2px 0; font-size: 10px;"><strong>Course:</strong> <span style="color: #0891b2; font-weight: 600;">${student.course}</span></p>
                        </div>
                    </div>

                    <!-- Details Grid (2 columns) -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                        <div style="background: #f9fafb; padding: 10px; border-radius: 6px; border-left: 3px solid #4f46e5;">
                            <p style="margin: 0 0 4px 0; font-size: 9px; font-weight: 700; color: #6b7280; text-transform: uppercase;">üìß Email</p>
                            <p style="margin: 0; font-size: 11px; font-weight: 500;">${student.email}</p>
                        </div>
                        <div style="background: #f9fafb; padding: 10px; border-radius: 6px; border-left: 3px solid #7c3aed;">
                            <p style="margin: 0 0 4px 0; font-size: 9px; font-weight: 700; color: #6b7280; text-transform: uppercase;">üì± Phone</p>
                            <p style="margin: 0; font-size: 11px; font-weight: 500;">${student.phone || 'N/A'}</p>
                        </div>
                        <div style="background: #f9fafb; padding: 10px; border-radius: 6px; border-left: 3px solid #06b6d4;">
                            <p style="margin: 0 0 4px 0; font-size: 9px; font-weight: 700; color: #6b7280; text-transform: uppercase;">üìÖ Enrollment Date</p>
                            <p style="margin: 0; font-size: 11px; font-weight: 500;">${student.enrollDate || 'N/A'}</p>
                        </div>
                        <div style="background: #f9fafb; padding: 10px; border-radius: 6px; border-left: 3px solid #ec4899;">
                            <p style="margin: 0 0 4px 0; font-size: 9px; font-weight: 700; color: #6b7280; text-transform: uppercase;">üí∞ Total Fees</p>
                            <p style="margin: 0; font-size: 11px; font-weight: bold; color: #dc2626;">‚Çπ${student.fees || '0'}</p>
                        </div>
                        <div style="background: #f9fafb; padding: 10px; border-radius: 6px; border-left: 3px solid #10b981;">
                            <p style="margin: 0 0 4px 0; font-size: 9px; font-weight: 700; color: #6b7280; text-transform: uppercase;">‚úÖ Status</p>
                            <p style="margin: 0; font-size: 11px; font-weight: 600; color: ${student.status === 'Active' ? '#059669' : '#ca8a04'};">${student.status}</p>
                        </div>
                        <div style="background: #f9fafb; padding: 10px; border-radius: 6px; border-left: 3px solid #f59e0b;">
                            <p style="margin: 0 0 4px 0; font-size: 9px; font-weight: 700; color: #6b7280; text-transform: uppercase;">üìç Address</p>
                            <p style="margin: 0; font-size: 11px; font-weight: 500;">${student.address || 'N/A'}</p>
                        </div>
                    </div>

                    <!-- Signature Section (Compact) -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 12px;">
                        <div style="text-align: center;">
                            <div style="border-top: 1px solid #1f2937; padding-top: 4px;">
                                <p style="margin: 3px 0 0 0; font-size: 9px; font-weight: 600;">Principal / Director</p>
                            </div>
                        </div>
                        <div style="text-align: center;">
                            <div style="border-top: 1px solid #1f2937; padding-top: 4px;">
                                <p style="margin: 3px 0 0 0; font-size: 9px; font-weight: 600;">Student / Parent</p>
                            </div>
                        </div>
                    </div>

                    <!-- Footer -->
                    <div style="background: linear-gradient(90deg, #f0f4ff 0%, #f5f3ff 100%); padding: 10px; border-radius: 8px; text-align: center; margin-top: 12px; border: 1px solid #4f46e5;">
                        <p style="margin: 3px 0; font-size: 9px; font-weight: 600; color: #4f46e5;">AAYAT ACADEMY | üìû 8181867118 | üìß info@aacti.in</p>
                        <p style="margin: 2px 0; font-size: 8px; color: #6b7280;">Generated: ${new Date().toLocaleDateString('en-IN')}</p>
                    </div>
                </div>
            `;

            const options = {
                margin: 5,
                filename: student.admissionNo + '_StudentAdmissionForm.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { orientation: 'portrait', unit: 'mm', format: 'a4' }
            };

            html2pdf().set(options).from(element).save();
            alert('‚úÖ Admission Form downloaded successfully!');
        }

        function downloadStudentInfoPDF() {
            if (!currentStudent) {
                alert('‚ùå Please login first');
                return;
            }

            const element = document.createElement('div');
            element.innerHTML = `
                <div style="font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto;">
                    <div style="text-align: center; margin-bottom: 40px; border-bottom: 3px solid #4f46e5; padding-bottom: 20px;">
                        <h1 style="color: #1f2937; margin: 0; font-size: 28px;">AAYAT ACADEMY</h1>
                        <p style="color: #6b7280; margin: 5px 0; font-size: 12px;">Computer Training Institute</p>
                        <p style="color: #6b7280; margin: 5px 0; font-size: 11px;">Empowering Students Through Quality Education</p>
                    </div>

                    <div style="margin-bottom: 30px;">
                        <h2 style="color: #1f2937; border-bottom: 2px solid #4f46e5; padding-bottom: 10px; font-size: 18px;">Student Information</h2>
                        <div style="background-color: #f3f4f6; padding: 15px; border-radius: 5px; margin-top: 15px;">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; font-weight: bold; color: #374151; width: 40%;">Full Name:</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; color: #1f2937;">${currentStudent.name}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; font-weight: bold; color: #374151;">Admission ID:</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; color: #1f2937; font-family: monospace; font-weight: bold;">${currentStudent.admissionNo}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; font-weight: bold; color: #374151;">Email Address:</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; color: #1f2937;">${currentStudent.email}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; font-weight: bold; color: #374151;">Mobile Number:</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; color: #1f2937;">${currentStudent.phone}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; font-weight: bold; color: #374151;">Course:</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; color: #1f2937;">${currentStudent.course}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; font-weight: bold; color: #374151;">Enrollment Date:</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; color: #1f2937;">${currentStudent.enrollDate}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; font-weight: bold; color: #374151;">Total Course Fees:</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; color: #1f2937; font-weight: bold;">‚Çπ${currentStudent.fees}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; font-weight: bold; color: #374151;">Student Status:</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #d1d5db; color: #1f2937;">
                                        <span style="background-color: #d1fae5; color: #065f46; padding: 4px 8px; border-radius: 3px; font-weight: bold; font-size: 12px;">${currentStudent.status}</span>
                                    </td>
                                </tr>
                                ${currentStudent.address ? `
                                <tr>
                                    <td style="padding: 12px; font-weight: bold; color: #374151;">Address:</td>
                                    <td style="padding: 12px; color: #1f2937;">${currentStudent.address}</td>
                                </tr>
                                ` : ''}
                            </table>
                        </div>
                    </div>

                    <div style="margin-top: 50px; padding-top: 20px; border-top: 2px solid #d1d5db; text-align: center; color: #6b7280; font-size: 11px;">
                        <p>Generated on: ${new Date().toLocaleString('en-IN')}</p>
                        <p>This is an official record from AAYAT ACADEMY</p>
                        <p style="font-size: 10px; margin-top: 10px;">Contact: 8181867118 | Email: info@aacti.in</p>
                    </div>
                </div>
            `;

            const options = {
                margin: 10,
                filename: `${currentStudent.admissionNo}_StudentInfo.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { orientation: 'portrait', unit: 'mm', format: 'a4' }
            };

            html2pdf().set(options).from(element).save();
        }

        // ============== ADMISSION FORM FUNCTIONS ==============

        let admissionPhotoData = null;

        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            // Check file size (max 2MB)
            if (file.size > 2 * 1024 * 1024) {
                alert('‚ùå Photo size must be less than 2MB');
                return;
            }

            // Check file type
            if (!file.type.startsWith('image/')) {
                alert('‚ùå Please upload a valid image file');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                admissionPhotoData = e.target.result;
                document.getElementById('photoPreviewImg').src = admissionPhotoData;
                document.getElementById('photoPreview').classList.remove('hidden');
            };
            reader.readAsDataURL(file);
        }

        function clearPhoto() {
            admissionPhotoData = null;
            document.getElementById('admissionPhoto').value = '';
            document.getElementById('photoPreview').classList.add('hidden');
        }

        function toggleAdmissionPasswordVisibility() {
            const input = document.getElementById('admissionPassword');
            if (input.type === 'password') {
                input.type = 'text';
            } else {
                input.type = 'password';
            }
        }

        function toggleAdmissionConfirmPasswordVisibility() {
            const input = document.getElementById('admissionConfirmPassword');
            if (input.type === 'password') {
                input.type = 'text';
            } else {
                input.type = 'password';
            }
        }

        function submitAdmissionForm(event) {
            event.preventDefault();

            // Check if photo is uploaded
            if (!admissionPhotoData) {
                alert('‚ùå Please upload your passport size photo');
                return;
            }

            const password = document.getElementById('admissionPassword').value.trim();
            const confirmPassword = document.getElementById('admissionConfirmPassword').value.trim();

            // Validate password
            if (!password) {
                alert('‚ùå Please enter a password');
                return;
            }

            if (password.length < 6) {
                alert('‚ùå Password must be at least 6 characters long');
                return;
            }

            if (password !== confirmPassword) {
                alert('‚ùå Passwords do not match!');
                return;
            }

            // Check password strength (at least one letter and one number)
            if (!/[a-zA-Z]/.test(password) || !/[0-9]/.test(password)) {
                alert('‚ùå Password must contain both letters and numbers');
                return;
            }

            const formData = {
                id: students.length + 1,
                name: document.getElementById('admissionName').value.trim(),
                email: document.getElementById('admissionEmail').value.trim(),
                phone: document.getElementById('admissionPhone').value.trim(),
                course: document.getElementById('admissionCourse').value,
                enrollDate: document.getElementById('admissionEnrollDate').value,
                fees: document.getElementById('admissionFees').value,
                address: document.getElementById('admissionAddress').value.trim(),
                photo: admissionPhotoData,
                admissionNo: generateAdmissionNumber(),
                password: password,
                status: 'Active'
            };

            // Add to students array
            students.push(formData);
            localStorage.setItem('aactiStudents', JSON.stringify(students));

            // Also add to admin students list
            adminStudents.push(formData);
            saveStudents();

            // Show success message
            document.getElementById('admissionFormElement').classList.add('hidden');
            const successMsg = document.getElementById('admissionSuccessMessage');
            successMsg.classList.remove('hidden');

            // Reset form
            setTimeout(() => {
                document.getElementById('admissionFormElement').reset();
                clearPhoto();
                admissionPhotoData = null;
                document.getElementById('admissionFormElement').classList.remove('hidden');
                successMsg.classList.add('hidden');
                switchStudentPortalTab('login');
            }, 3000);

            console.log('New Student Added:', formData);
        }

        function generateAdmissionNumber() {
            const year = new Date().getFullYear();
            const count = students.length + 1;
            return `AACTI/${year}/${String(count).padStart(3, '0')}`;
        }

        function generateRandomPassword() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$!';
            let password = '';
            for (let i = 0; i < 8; i++) {
                password += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return password;
        }

        // ============== STUDENT EXAM FUNCTIONS ==============
        let studentExamAnswers = {};
        let currentStudentExam = null;
        let studentExamStartTime = null;
        let studentTimerInterval = null;
        let studentExamResults = JSON.parse(localStorage.getItem('studentExamResults')) || [];

        function switchStudentTab(tab) {
            document.getElementById('studentTakeExam').classList.add('hidden');
            document.getElementById('studentExamInterface').classList.add('hidden');
            document.getElementById('studentResults').classList.add('hidden');
            document.getElementById('studentEditProfile').classList.add('hidden');
            document.getElementById('studentCourseNotes').classList.add('hidden');
            document.getElementById('studentCourseVideos').classList.add('hidden');
            
            if (tab === 'takeExam') {
                document.getElementById('studentTakeExam').classList.remove('hidden');
                loadStudentAvailableExams();
            } else if (tab === 'results') {
                document.getElementById('studentResults').classList.remove('hidden');
                loadStudentResultsList();
            } else if (tab === 'editProfile') {
                document.getElementById('studentEditProfile').classList.remove('hidden');
                loadEditProfileForm();
            } else if (tab === 'courseNotes') {
                document.getElementById('studentCourseNotes').classList.remove('hidden');
                if (currentStudent) {
                    loadStudentCourseNotes(currentStudent.course);
                }
            } else if (tab === 'courseVideos') {
                document.getElementById('studentCourseVideos').classList.remove('hidden');
                if (currentStudent) {
                    loadStudentCourseVideos(currentStudent.course);
                }
            } else if (tab === 'profile') {
                // Do nothing - just hide all tabs
            }
        }

        function loadStudentAvailableExams() {
            const exams = JSON.parse(localStorage.getItem('aactiExams')) || [];
            const container = document.getElementById('studentAvailableExamsContainer');
            container.innerHTML = '';

            if (!currentStudent) {
                container.innerHTML = '<p class="text-gray-600">Please login first.</p>';
                return;
            }

            const relevantExams = exams.filter(exam => exam.course === currentStudent.course);

            if (relevantExams.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-600 py-8">No exams available for your course yet.</p>';
                return;
            }

            relevantExams.forEach(exam => {
                const alreadyTaken = studentExamResults.find(r => r.examId === exam.id && r.studentId === currentStudent.id);
                
                const examCard = document.createElement('div');
                examCard.className = 'bg-gradient-to-r from-indigo-50 to-blue-50 p-6 rounded-lg border-l-4 border-indigo-600 hover:shadow-lg transition';
                examCard.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h3 class="text-xl font-bold text-indigo-900">${exam.title}</h3>
                            <p class="text-sm text-gray-600">${exam.description}</p>
                        </div>
                        ${alreadyTaken ? '<span class="bg-green-100 text-green-900 px-3 py-1 rounded font-bold text-sm">‚úÖ Completed</span>' : ''}
                    </div>
                    <div class="grid grid-cols-4 gap-2 text-sm text-center mb-4">
                        <div class="bg-white p-2 rounded border border-blue-300">
                            <p class="font-bold text-blue-900">${exam.questions.length}</p>
                            <p class="text-gray-600 text-xs">Questions</p>
                        </div>
                        <div class="bg-white p-2 rounded border border-green-300">
                            <p class="font-bold text-green-900">${exam.totalMarks}</p>
                            <p class="text-gray-600 text-xs">Marks</p>
                        </div>
                        <div class="bg-white p-2 rounded border border-orange-300">
                            <p class="font-bold text-orange-900">${exam.passMarks}</p>
                            <p class="text-gray-600 text-xs">Pass</p>
                        </div>
                        <div class="bg-white p-2 rounded border border-purple-300">
                            <p class="font-bold text-purple-900">${exam.duration}</p>
                            <p class="text-gray-600 text-xs">Min</p>
                        </div>
                    </div>
                    <button onclick="startStudentExam(${exam.id})" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 rounded-lg transition">
                        ${alreadyTaken ? 'üîÑ Retake Exam' : '‚ñ∂Ô∏è Start Exam'}
                    </button>
                `;
                container.appendChild(examCard);
            });
        }

        function startStudentExam(examId) {
            const exams = JSON.parse(localStorage.getItem('aactiExams')) || [];
            currentStudentExam = exams.find(e => e.id === examId);

            if (!currentStudentExam) {
                alert('‚ùå Exam not found!');
                return;
            }

            studentExamAnswers = {};
            studentExamStartTime = Date.now();
            
            document.getElementById('studentTakeExam').classList.add('hidden');
            document.getElementById('studentExamInterface').classList.remove('hidden');

            displayStudentExam();
            startStudentTimer();
        }

        function displayStudentExam() {
            document.getElementById('studentExamTitle').textContent = currentStudentExam.title;
            document.getElementById('studentTotalQuestionsDisplay').textContent = currentStudentExam.questions.length;
            document.getElementById('studentExamMarksDisplay').textContent = currentStudentExam.totalMarks;

            const questionsDisplay = document.getElementById('studentQuestionsDisplay');
            questionsDisplay.innerHTML = '';

            currentStudentExam.questions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'bg-gray-50 p-6 rounded-lg border-l-4 border-blue-600';
                let questionHTML = `
                    <h3 class="font-bold text-lg text-indigo-900 mb-3">Q${index + 1}. ${question.text} <span class="text-sm text-orange-600">(${question.marks} marks)</span></h3>
                `;

                if (question.type === 'mcq') {
                    questionHTML += '<div class="space-y-2">';
                    ['A', 'B', 'C', 'D'].forEach((letter, optIndex) => {
                        const isSelected = studentExamAnswers[question.id] === letter;
                        questionHTML += `
                            <label class="flex items-center p-3 bg-white rounded border-2 ${isSelected ? 'border-indigo-600 bg-indigo-50' : 'border-gray-300'} cursor-pointer hover:border-indigo-400 transition">
                                <input type="radio" name="q${question.id}" value="${letter}" 
                                       ${isSelected ? 'checked' : ''} 
                                       onchange="updateStudentAnswer('${question.id}', '${letter}')" 
                                       class="mr-3 w-4 h-4">
                                <span class="font-medium">${letter}. ${question.options[optIndex]}</span>
                            </label>
                        `;
                    });
                    questionHTML += '</div>';
                } else {
                    const answer = studentExamAnswers[question.id] || '';
                    questionHTML += `
                        <input type="text" 
                               value="${answer}" 
                               onchange="updateStudentAnswer('${question.id}', this.value)"
                               placeholder="Type your answer here..." 
                               class="input-field">
                    `;
                }

                questionDiv.innerHTML = questionHTML;
                questionsDisplay.appendChild(questionDiv);
            });
        }

        function updateStudentAnswer(questionId, answer) {
            studentExamAnswers[questionId] = answer;
        }

        function startStudentTimer() {
            let timeRemaining = currentStudentExam.duration * 60;
            
            const updateTimer = () => {
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                document.getElementById('studentTimerDisplay').textContent = 
                    `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                
                if (timeRemaining <= 0) {
                    clearInterval(studentTimerInterval);
                    alert('‚è±Ô∏è Time is up! Your exam will be submitted automatically.');
                    submitStudentExam();
                }
                
                timeRemaining--;
            };

            updateTimer();
            studentTimerInterval = setInterval(updateTimer, 1000);
        }

        function submitStudentExam() {
            clearInterval(studentTimerInterval);

            if (!confirm('Are you sure you want to submit the exam?')) {
                startStudentTimer();
                return;
            }

            let correctAnswers = 0;
            let obtainedMarks = 0;
            const detailedResults = [];

            currentStudentExam.questions.forEach(question => {
                const studentAnswer = studentExamAnswers[question.id] || '';
                let isCorrect = false;

                if (question.type === 'mcq') {
                    isCorrect = studentAnswer === question.correctAnswer;
                } else {
                    isCorrect = studentAnswer.trim().toLowerCase() === question.correctAnswer.trim().toLowerCase();
                }

                if (isCorrect) {
                    correctAnswers++;
                    obtainedMarks += question.marks;
                }

                detailedResults.push({
                    questionId: question.id,
                    question: question.text,
                    studentAnswer: studentAnswer || 'Not answered',
                    correctAnswer: question.correctAnswer,
                    isCorrect: isCorrect,
                    marks: question.marks,
                    obtainedMarks: isCorrect ? question.marks : 0
                });
            });

            const isPassed = obtainedMarks >= currentStudentExam.passMarks;
            const percentage = Math.round((obtainedMarks / currentStudentExam.totalMarks) * 100);

            const result = {
                examId: currentStudentExam.id,
                examTitle: currentStudentExam.title,
                studentId: currentStudent.id,
                studentName: currentStudent.name,
                obtainedMarks: obtainedMarks,
                totalMarks: currentStudentExam.totalMarks,
                passMarks: currentStudentExam.passMarks,
                isPassed: isPassed,
                percentage: percentage,
                correctAnswers: correctAnswers,
                totalQuestions: currentStudentExam.questions.length,
                completedAt: new Date().toLocaleString(),
                detailedResults: detailedResults
            };

            studentExamResults.push(result);
            localStorage.setItem('studentExamResults', JSON.stringify(studentExamResults));

            showStudentExamResult(result);
        }

        function showStudentExamResult(result) {
            document.getElementById('studentExamInterface').classList.add('hidden');
            document.getElementById('studentTakeExam').classList.add('hidden');
            document.getElementById('studentResults').classList.remove('hidden');

            const resultHTML = `
                <div class="bg-gradient-to-r ${result.isPassed ? 'from-green-100 to-green-50' : 'from-red-100 to-red-50'} p-8 rounded-lg border-l-4 ${result.isPassed ? 'border-green-600' : 'border-red-600'} mb-8">
                    <div class="text-center">
                        <h2 class="text-3xl font-bold ${result.isPassed ? 'text-green-900' : 'text-red-900'} mb-2">
                            ${result.isPassed ? 'üéâ PASSED' : '‚ùå FAILED'}
                        </h2>
                        <p class="text-lg font-bold ${result.isPassed ? 'text-green-800' : 'text-red-800'} mb-4">
                            You scored ${result.obtainedMarks} out of ${result.totalMarks} (${result.percentage}%)
                        </p>
                    </div>

                    <div class="grid grid-cols-4 gap-4 mb-6">
                        <div class="bg-white p-4 rounded-lg text-center border-b-4 border-blue-500">
                            <p class="text-2xl font-bold text-blue-900">${result.correctAnswers}</p>
                            <p class="text-sm text-gray-600">Correct Answers</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg text-center border-b-4 border-red-500">
                            <p class="text-2xl font-bold text-red-900">${result.totalQuestions - result.correctAnswers}</p>
                            <p class="text-sm text-gray-600">Wrong Answers</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg text-center border-b-4 border-green-500">
                            <p class="text-2xl font-bold text-green-900">${result.obtainedMarks}/${result.totalMarks}</p>
                            <p class="text-sm text-gray-600">Total Marks</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg text-center border-b-4 border-orange-500">
                            <p class="text-2xl font-bold text-orange-900">${result.percentage}%</p>
                            <p class="text-sm text-gray-600">Percentage</p>
                        </div>
                    </div>

                    <div class="border-t-2 pt-6">
                        <h3 class="font-bold text-lg text-gray-800 mb-4">üìã Answer Key</h3>
                        <div class="space-y-3">
                            ${result.detailedResults.map((res, idx) => `
                                <div class="bg-white p-4 rounded-lg border-l-4 ${res.isCorrect ? 'border-green-500' : 'border-red-500'}">
                                    <p class="font-bold text-gray-800">Q${idx + 1}. ${res.question}</p>
                                    <p class="text-sm text-gray-600 mt-2">
                                        <strong>Your Answer:</strong> <span class="${res.isCorrect ? 'text-green-700' : 'text-red-700'} font-bold">${res.studentAnswer}</span>
                                        ${!res.isCorrect ? ` | <strong>Correct Answer:</strong> <span class="text-green-700">${res.correctAnswer}</span>` : ''}
                                    </p>
                                    <p class="text-sm text-gray-600 mt-1">
                                        <strong>Marks:</strong> ${res.obtainedMarks}/${res.marks}
                                    </p>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="mt-6 flex gap-4 justify-center">
                        <button onclick="loadStudentAvailableExams(); document.getElementById('studentResults').classList.add('hidden'); document.getElementById('studentTakeExam').classList.remove('hidden');" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold px-6 py-2 rounded-lg transition">‚Üê Back to Exams</button>
                    </div>
                </div>
            `;

            document.getElementById('studentResultsContainer').innerHTML = resultHTML;
        }

        function exitStudentExam() {
            if (confirm('Are you sure you want to exit without submitting? Your answers will be lost.')) {
                clearInterval(studentTimerInterval);
                currentStudentExam = null;
                studentExamAnswers = {};
                document.getElementById('studentExamInterface').classList.add('hidden');
                document.getElementById('studentTakeExam').classList.remove('hidden');
                loadStudentAvailableExams();
            }
        }

        function loadStudentResultsList() {
            const container = document.getElementById('studentResultsContainer');
            const myResults = studentExamResults.filter(r => r.studentId === currentStudent.id);

            if (myResults.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-600 py-8">No exam results yet. Take an exam to see your results here.</p>';
                return;
            }

            let resultsHTML = '';
            myResults.forEach(result => {
                resultsHTML += `
                    <div class="bg-white p-6 rounded-lg border-l-4 ${result.isPassed ? 'border-green-600' : 'border-red-600'} hover:shadow-lg transition">
                        <div class="flex justify-between items-start mb-3">
                            <div>
                                <h3 class="text-lg font-bold text-indigo-900">${result.examTitle}</h3>
                                <p class="text-sm text-gray-600">${result.completedAt}</p>
                            </div>
                            <span class="px-4 py-2 rounded font-bold text-white ${result.isPassed ? 'bg-green-600' : 'bg-red-600'}">
                                ${result.isPassed ? '‚úÖ PASSED' : '‚ùå FAILED'}
                            </span>
                        </div>
                        <div class="grid grid-cols-4 gap-2 text-center text-sm">
                            <div class="bg-blue-50 p-2 rounded">
                                <p class="font-bold text-blue-900">${result.obtainedMarks}/${result.totalMarks}</p>
                                <p class="text-gray-600">Marks</p>
                            </div>
                            <div class="bg-green-50 p-2 rounded">
                                <p class="font-bold text-green-900">${result.percentage}%</p>
                                <p class="text-gray-600">Percentage</p>
                            </div>
                            <div class="bg-purple-50 p-2 rounded">
                                <p class="font-bold text-purple-900">${result.correctAnswers}/${result.totalQuestions}</p>
                                <p class="text-gray-600">Correct</p>
                            </div>
                            <div class="bg-orange-50 p-2 rounded">
                                <p class="font-bold text-orange-900">${result.isPassed ? 'Pass ‚úì' : 'Fail ‚úó'}</p>
                                <p class="text-gray-600">Status</p>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = resultsHTML;
        }

        // ============== STUDENT COURSE NOTES ============== 
        const courseNotesData = {
            'CCC': [
                { unit: 'Unit 1', title: 'CCC SYLLABUS', link: 'https://drive.google.com/file/d/1TQDo9820IUhD-PhCdOhJ1G8tRyxTPH5M/view?usp=sharing', description: 'Complete CCC syllabus overview and course structure' },
                { unit: 'Unit 2', title: 'CCC HINDI NOTES', link: 'https://drive.google.com/file/d/1X8fOgX6_GxrZ-zoSKGZN5vrqihCf0cyN/view?usp=drive_link', description: 'Comprehensive study notes in Hindi language' },
                { unit: 'Unit 3', title: 'CCC ENGLISH NOTES', link: 'https://drive.google.com/file/d/1X8fOgX6_GxrZ-zoSKGZN5vrqihCf0cyN/view?usp=drive_link', description: 'Comprehensive study notes in English language' }
            ],
            'ADCA': [
                { unit: 'Module 1', title: 'ADCA SYLLABUS', link: 'https://drive.google.com/file/d/1RgVrKvtJsK2JKdd8W7EDD13IDQdsJmUW/view?usp=drive_link', description: 'ADCA course syllabus and learning objectives' },
                { unit: 'Module 2', title: 'ADCA ENGLISH NOTES', link: 'https://drive.google.com/file/d/1Kl73hlxVwcLqMAZuOF8HJ4BZzmpkyKpH/view?usp=drive_link', description: 'Advanced Diploma study materials in English' }
            ],
            'DCA': [
                { unit: 'Module 1', title: 'DCA Fundamental Notes', link: '#', description: 'Basic concepts and fundamentals of DCA course' }
            ],
            'BCA': [
                { unit: 'Semester 1', title: 'C Programming Basics', link: '#', description: 'Introduction to C programming language for BCA' }
            ],
            'O-Level': [
                { unit: 'M1-R5', title: 'IT Tools and Applications', link: '#', description: 'NIELIT O-Level IT tools and practical applications' }
            ],
            'Python': [
                { unit: 'Module 1', title: 'Python Intro & Syntax', link: '#', description: 'Python programming introduction and syntax fundamentals' }
            ],
            'Java': [
                { unit: 'Module 1', title: 'Java Programming Basics', link: '#', description: 'Introduction to Java programming language' }
            ],
            'Tally': [
                { unit: 'Module 1', title: 'Tally ERP Basics', link: '#', description: 'Tally ERP accounting software basics' }
            ]
        };

        function loadStudentCourseNotes() {
            if (!currentStudent) {
                alert('‚ùå Please login first');
                return;
            }

            const course = currentStudent.course;
            const notes = courseNotesData[course] || [];
            const container = document.getElementById('courseNotesContainer');
            
            // Set the course title
            document.getElementById('courseNotesTitle').textContent = course;

            if (notes.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-600 py-8">No study materials available for your course yet. Please check back soon!</p>';
                return;
            }

            container.innerHTML = notes.map((note, index) => `
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border-l-4 border-blue-600 hover:shadow-lg transition">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex-1">
                            <div class="inline-block bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-bold mb-2">${note.unit}</div>
                            <h3 class="text-xl font-bold text-indigo-900 mb-2">${note.title}</h3>
                            <p class="text-sm text-gray-700">${note.description}</p>
                        </div>
                        <div class="text-3xl ml-4">üìÑ</div>
                    </div>
                    <div class="flex gap-3 pt-4 border-t border-blue-200">
                        <a href="${note.link}" target="_blank" rel="noopener noreferrer" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition text-center text-sm">
                            üëÅÔ∏è View Notes
                        </a>
                        <a href="${note.link}" target="_blank" rel="noopener noreferrer" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition text-center text-sm">
                            üì• Download
                        </a>
                    </div>
                </div>
            `).join('');
        }
 
        let adminStudents = JSON.parse(localStorage.getItem('aactiStudents')) || students;
        let nextStudentId = Math.max(...adminStudents.map(s => s.id), 0) + 1;
        let selectedStudentId = null;
        const adminUsername = "AACTI";
        const adminPassword = "AACTI1";

        function loginAdmin() {
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            if (username === adminUsername && password === adminPassword) {
                document.getElementById('adminLoginSection').classList.add('hidden');
                document.getElementById('adminPanelSection').classList.remove('hidden');
                localStorage.setItem('adminLoggedIn', 'true');
                loadStudentsTable();
                loadCredentialSelectOptions();
                switchAdminTab('addStudent');
            } else {
                alert('‚ùå Invalid credentials! De: admin / admin123');
            }
        }

        function logoutAdmin() {
            localStorage.removeItem('adminLoggedIn');
            document.getElementById('adminLoginSection').classList.remove('hidden');
            document.getElementById('adminPanelSection').classList.add('hidden');
            document.getElementById('adminUsername').value = 'admin';
            document.getElementById('adminPassword').value = 'admin123';
        }

        function switchAdminTab(tab) {
            document.querySelectorAll('.admin-tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(tab).classList.remove('hidden');
            
            // Load announcements when announcements tab is clicked
            if (tab === 'announcements') {
                loadAnnouncements();
            } else if (tab === 'uploadNotes') {
                loadAllNotes();
            } else if (tab === 'uploadVideos') {
                loadAllVideos();
            }
        }

        // ============== ANNOUNCEMENTS FUNCTIONS ==============
        let announcements = JSON.parse(localStorage.getItem('aactiAnnouncements')) || [];

        function createAnnouncement() {
            const title = document.getElementById('announcementTitle').value.trim();
            const message = document.getElementById('announcementMessage').value.trim();
            const priority = document.getElementById('announcementPriority').value;

            if (!title || !message) {
                alert('‚ùå Please fill in title and message!');
                return;
            }

            const announcement = {
                id: Date.now(),
                title: title,
                message: message,
                priority: priority,
                date: new Date().toLocaleDateString('en-IN'),
                time: new Date().toLocaleTimeString('en-IN'),
                adminName: 'Admin'
            };

            announcements.unshift(announcement);
            localStorage.setItem('aactiAnnouncements', JSON.stringify(announcements));

            // Clear form
            document.getElementById('announcementTitle').value = '';
            document.getElementById('announcementMessage').value = '';
            document.getElementById('announcementPriority').value = 'Normal';

            loadAnnouncements();
            alert('‚úÖ Announcement posted successfully!');
        }

        function loadAnnouncements() {
            const container = document.getElementById('announcementsList');
            announcements = JSON.parse(localStorage.getItem('aactiAnnouncements')) || [];

            if (announcements.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-600 py-8">No announcements yet.</p>';
                return;
            }

            container.innerHTML = announcements.map(announcement => {
                const priorityColor = 
                    announcement.priority === 'Urgent' ? 'bg-red-100 text-red-900 border-red-300' :
                    announcement.priority === 'Important' ? 'bg-yellow-100 text-yellow-900 border-yellow-300' :
                    'bg-blue-100 text-blue-900 border-blue-300';

                return `
                    <div class="border-2 ${priorityColor} rounded-lg p-4">
                        <div class="flex justify-between items-start mb-2">
                            <div>
                                <h4 class="text-lg font-bold">${announcement.title}</h4>
                                <p class="text-xs opacity-75">${announcement.date} at ${announcement.time}</p>
                            </div>
                            <div class="flex gap-2">
                                <span class="px-3 py-1 rounded-full text-xs font-bold bg-white">${announcement.priority}</span>
                                <button onclick="deleteAnnouncement(${announcement.id})" class="text-red-600 hover:text-red-900 font-bold">üóëÔ∏è</button>
                            </div>
                        </div>
                        <p class="text-sm">${announcement.message}</p>
                    </div>
                `;
            }).join('');
        }

        function deleteAnnouncement(id) {
            if (confirm('Are you sure you want to delete this announcement?')) {
                announcements = announcements.filter(a => a.id !== id);
                localStorage.setItem('aactiAnnouncements', JSON.stringify(announcements));
                loadAnnouncements();
                alert('‚úÖ Announcement deleted!');
            }
        }

        // ============== UPLOAD NOTES FUNCTIONS ==============
        let courseNotes = JSON.parse(localStorage.getItem('aactiCourseNotes')) || [];
        let uploadedNotesFile = null;

        function handleNotesFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            // Check file size (max 10MB)
            if (file.size > 10 * 1024 * 1024) {
                alert('‚ùå File size exceeds 10MB limit!');
                return;
            }

            uploadedNotesFile = file;
            document.getElementById('notesFilePreview').classList.remove('hidden');
            document.getElementById('notesFileName').textContent = file.name;
        }

        function clearNotesFile() {
            uploadedNotesFile = null;
            document.getElementById('notesFileUpload').value = '';
            document.getElementById('notesFilePreview').classList.add('hidden');
            document.getElementById('notesFileName').textContent = '';
        }

        function uploadNotes() {
            const course = document.getElementById('notesUploadCourse').value.trim();
            const title = document.getElementById('notesTitle').value.trim();
            const description = document.getElementById('notesDescription').value.trim();

            if (!course || !title || !uploadedNotesFile) {
                alert('‚ùå Please fill all required fields and upload a file!');
                return;
            }

            // Convert file to base64
            const reader = new FileReader();
            reader.onload = function(e) {
                const note = {
                    id: Date.now(),
                    course: course,
                    title: title,
                    description: description,
                    fileName: uploadedNotesFile.name,
                    fileData: e.target.result,
                    fileSize: uploadedNotesFile.size,
                    uploadDate: new Date().toLocaleDateString('en-IN'),
                    uploadTime: new Date().toLocaleTimeString('en-IN'),
                    uploadedBy: 'Admin'
                };

                courseNotes.unshift(note);
                localStorage.setItem('aactiCourseNotes', JSON.stringify(courseNotes));

                // Clear form
                document.getElementById('notesUploadCourse').value = '';
                document.getElementById('notesTitle').value = '';
                document.getElementById('notesDescription').value = '';
                clearNotesFile();

                loadAllNotes();
                alert('‚úÖ Notes uploaded successfully!');
            };
            reader.readAsDataURL(uploadedNotesFile);
        }

        function loadAllNotes() {
            const container = document.getElementById('allNotesList');
            courseNotes = JSON.parse(localStorage.getItem('aactiCourseNotes')) || [];

            if (courseNotes.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-600 py-8 col-span-full">No notes uploaded yet.</p>';
                return;
            }

            container.innerHTML = courseNotes.map(note => {
                const fileSize = (note.fileSize / 1024).toFixed(2); // Convert to KB
                return `
                    <div class="border-2 border-cyan-300 rounded-lg p-4 bg-cyan-50 hover:bg-cyan-100 transition">
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex-1">
                                <h4 class="text-lg font-bold text-cyan-900 flex items-center gap-2">
                                    <i data-lucide="file-text" class="w-5 h-5"></i>
                                    ${note.title}
                                </h4>
                                <div class="flex gap-4 mt-2 text-sm text-cyan-700">
                                    <span class="bg-cyan-200 px-3 py-1 rounded-full font-bold">${note.course}</span>
                                    <span>üìÖ ${note.uploadDate}</span>
                                    <span>üìÑ ${fileSize} KB</span>
                                </div>
                            </div>
                            <button onclick="deleteNote(${note.id})" class="text-red-600 hover:text-red-900 font-bold text-xl">√ó</button>
                        </div>
                        <p class="text-sm text-gray-700 mb-3">${note.description || 'No description'}</p>
                        <div class="flex gap-2">
                            <button onclick="downloadNote(${note.id})" class="flex-1 bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 rounded-lg transition">üì• Download</button>
                            <button onclick="viewNote(${note.id})" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 rounded-lg transition">üëÅÔ∏è View</button>
                        </div>
                    </div>
                `;
            }).join('');

            lucide.createIcons();
        }

        function downloadNote(id) {
            const note = courseNotes.find(n => n.id === id);
            if (!note) return;

            const link = document.createElement('a');
            link.href = note.fileData;
            link.download = note.fileName;
            link.click();
        }

        function viewNote(id) {
            const note = courseNotes.find(n => n.id === id);
            if (!note) return;

            window.open(note.fileData, '_blank');
        }

        function deleteNote(id) {
            if (confirm('Are you sure you want to delete this note?')) {
                courseNotes = courseNotes.filter(n => n.id !== id);
                localStorage.setItem('aactiCourseNotes', JSON.stringify(courseNotes));
                loadAllNotes();
                alert('‚úÖ Note deleted!');
            }
        }

        function loadStudentCourseNotes(studentCourse) {
            const container = document.getElementById('courseNotesContainer');
            courseNotes = JSON.parse(localStorage.getItem('aactiCourseNotes')) || [];

            // Filter notes by student's course
            const filteredNotes = courseNotes.filter(note => note.course === studentCourse);

            document.getElementById('courseNotesTitle').textContent = studentCourse;

            if (filteredNotes.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-600 py-8">No study materials available for your course yet. Check back soon!</p>';
                return;
            }

            container.innerHTML = filteredNotes.map(note => {
                const fileSize = (note.fileSize / 1024).toFixed(2);
                return `
                    <div class="border-2 border-blue-300 rounded-lg p-4 bg-blue-50 hover:bg-blue-100 transition">
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex-1">
                                <h4 class="text-lg font-bold text-blue-900 flex items-center gap-2">
                                    <i data-lucide="book-open" class="w-5 h-5"></i>
                                    ${note.title}
                                </h4>
                                <div class="flex gap-4 mt-2 text-sm text-blue-700">
                                    <span>üìÖ ${note.uploadDate}</span>
                                    <span>üìÑ ${fileSize} KB</span>
                                </div>
                            </div>
                        </div>
                        <p class="text-sm text-gray-700 mb-3">${note.description || 'Study material'}</p>
                        <div class="flex gap-2">
                            <button onclick="downloadNote(${note.id})" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 rounded-lg transition">üì• Download</button>
                            <button onclick="viewNote(${note.id})" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 rounded-lg transition">üëÅÔ∏è View</button>
                        </div>
                    </div>
                `;
            }).join('');

            lucide.createIcons();
        }

        // ============== UPLOAD VIDEOS FUNCTIONS ==============
        let courseVideos = JSON.parse(localStorage.getItem('aactiCourseVideos')) || [];

        function extractYouTubeID(url) {
            // Extract video ID from YouTube URL
            const patterns = [
                /(?:youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/,
                /^([a-zA-Z0-9_-]{11})$/ // Direct video ID
            ];
            for (let pattern of patterns) {
                const match = url.match(pattern);
                if (match) return match[1];
            }
            return null;
        }

        function uploadVideo() {
            const course = document.getElementById('videoUploadCourse').value.trim();
            const title = document.getElementById('videoTitle').value.trim();
            const videoURL = document.getElementById('videoURL').value.trim();
            const description = document.getElementById('videoDescription').value.trim();

            if (!course || !title || !videoURL) {
                alert('‚ùå Please fill all required fields!');
                return;
            }

            const videoID = extractYouTubeID(videoURL);
            if (!videoID) {
                alert('‚ùå Invalid YouTube URL! Please enter a valid YouTube video link or video ID');
                return;
            }

            const video = {
                id: Date.now(),
                course: course,
                title: title,
                videoID: videoID,
                description: description,
                uploadDate: new Date().toLocaleDateString('en-IN'),
                uploadTime: new Date().toLocaleTimeString('en-IN'),
                uploadedBy: 'Admin'
            };

            courseVideos.unshift(video);
            localStorage.setItem('aactiCourseVideos', JSON.stringify(courseVideos));

            // Clear form
            document.getElementById('videoUploadCourse').value = '';
            document.getElementById('videoTitle').value = '';
            document.getElementById('videoURL').value = '';
            document.getElementById('videoDescription').value = '';

            loadAllVideos();
            alert('‚úÖ Video uploaded successfully!');
        }

        function loadAllVideos() {
            const container = document.getElementById('allVideosList');
            courseVideos = JSON.parse(localStorage.getItem('aactiCourseVideos')) || [];

            if (courseVideos.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-600 py-8 col-span-full">No videos uploaded yet.</p>';
                return;
            }

            container.innerHTML = courseVideos.map(video => {
                return `
                    <div class="border-2 border-red-300 rounded-lg p-4 bg-red-50 hover:bg-red-100 transition">
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex-1">
                                <h4 class="text-lg font-bold text-red-900 flex items-center gap-2">
                                    <i data-lucide="play-circle" class="w-5 h-5"></i>
                                    ${video.title}
                                </h4>
                                <div class="flex gap-4 mt-2 text-sm text-red-700">
                                    <span class="bg-red-200 px-3 py-1 rounded-full font-bold">${video.course}</span>
                                    <span>üìÖ ${video.uploadDate}</span>
                                </div>
                            </div>
                            <button onclick="deleteVideo(${video.id})" class="text-red-600 hover:text-red-900 font-bold text-xl">√ó</button>
                        </div>
                        <p class="text-sm text-gray-700 mb-3">${video.description || 'Video lecture'}</p>
                        <div class="flex gap-2">
                            <button onclick="watchVideo('${video.videoID}')" class="flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-2 rounded-lg transition">‚ñ∂Ô∏è Watch Video</button>
                            <button onclick="openVideoFullScreen('${video.videoID}')" class="flex-1 bg-pink-600 hover:bg-pink-700 text-white font-bold py-2 rounded-lg transition">üñ•Ô∏è Full Screen</button>
                        </div>
                    </div>
                `;
            }).join('');

            lucide.createIcons();
        }

        function deleteVideo(id) {
            if (confirm('Are you sure you want to delete this video?')) {
                courseVideos = courseVideos.filter(v => v.id !== id);
                localStorage.setItem('aactiCourseVideos', JSON.stringify(courseVideos));
                loadAllVideos();
                alert('‚úÖ Video deleted!');
            }
        }

        function watchVideo(videoID) {
            window.open(`https://www.youtube.com/embed/${videoID}`, '_blank');
        }

        function openVideoFullScreen(videoID) {
            window.open(`https://www.youtube.com/watch?v=${videoID}`, '_blank');
        }

        function loadStudentCourseVideos(studentCourse) {
            const container = document.getElementById('courseVideosContainer');
            courseVideos = JSON.parse(localStorage.getItem('aactiCourseVideos')) || [];

            // Filter videos by student's course
            const filteredVideos = courseVideos.filter(video => video.course === studentCourse);

            document.getElementById('courseVideosTitle').textContent = studentCourse;

            if (filteredVideos.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-600 py-8">No video lectures available for your course yet. Check back soon!</p>';
                return;
            }

            container.innerHTML = filteredVideos.map(video => {
                return `
                    <div class="border-2 border-red-300 rounded-lg overflow-hidden bg-red-50 hover:shadow-lg transition">
                        <div class="relative bg-black h-64 flex items-center justify-center cursor-pointer group" onclick="openVideoFullScreen('${video.videoID}')">
                            <img src="https://img.youtube.com/vi/${video.videoID}/maxresdefault.jpg" alt="${video.title}" class="w-full h-full object-cover group-hover:opacity-75 transition">
                            <div class="absolute inset-0 flex items-center justify-center group-hover:bg-black/30 transition">
                                <i data-lucide="play" class="w-16 h-16 text-red-500 group-hover:text-white transition"></i>
                            </div>
                        </div>
                        <div class="p-4">
                            <h4 class="text-lg font-bold text-red-900 mb-2">${video.title}</h4>
                            <p class="text-sm text-gray-700 mb-3">${video.description || 'Video lecture'}</p>
                            <div class="flex gap-2">
                                <button onclick="openVideoFullScreen('${video.videoID}')" class="flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-2 rounded-lg transition">‚ñ∂Ô∏è Watch on YouTube</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            lucide.createIcons();
        }

        function addNewStudent() {
            const name = document.getElementById('studentName').value.trim();
            const email = document.getElementById('studentEmail').value.trim();
            const phone = document.getElementById('studentPhone').value.trim();
            const course = document.getElementById('studentCourse').value;
            const enrollDate = document.getElementById('studentEnrollDate').value;
            const fees = document.getElementById('studentFees').value.trim();

            if (!name || !email || !phone || !course || !enrollDate) {
                alert('‚ùå Please fill all required fields!');
                return;
            }

            const admissionNo = `AACTI/${new Date().getFullYear()}/${String(adminStudents.length + 1).padStart(3, '0')}`;
            const newStudent = {
                id: nextStudentId++,
                name, email, phone, course, enrollDate, fees,
                admissionNo, password: '', status: 'Pending'
            };
            
            adminStudents.push(newStudent);
            saveStudents();
            
            alert('‚úÖ Student added! Admission No: ' + admissionNo);
            document.getElementById('studentName').value = '';
            document.getElementById('studentEmail').value = '';
            document.getElementById('studentPhone').value = '';
            document.getElementById('studentCourse').value = '';
            document.getElementById('studentEnrollDate').value = '';
            document.getElementById('studentFees').value = '';
            
            loadStudentsTable();
            loadCredentialSelectOptions();
        }

        function loadStudentsTable() {
            const container = document.getElementById('studentListView');
            container.innerHTML = '';
            
            adminStudents.forEach(student => {
                const photoPreview = student.photo 
                    ? `<img src="${student.photo}" alt="Photo" class="h-40 w-full object-cover rounded-lg border-2 border-indigo-300">`
                    : '<div class="h-40 w-full bg-gray-200 rounded-lg flex items-center justify-center text-gray-400"><span>No Photo</span></div>';
                
                const card = `
                    <div class="bg-gradient-to-br from-white to-indigo-50 rounded-2xl shadow-lg border-l-4 border-indigo-600 p-6 hover:shadow-xl transition">
                        <div class="grid md:grid-cols-3 gap-4">
                            <div class="md:col-span-1">
                                ${photoPreview}
                            </div>
                            <div class="md:col-span-2 space-y-2">
                                <div>
                                    <h3 class="text-xl font-bold text-indigo-900">${student.name}</h3>
                                    <p class="text-xs text-gray-600">ID: ${student.admissionNo}</p>
                                </div>
                                <div class="grid md:grid-cols-2 gap-2 text-sm">
                                    <div>
                                        <span class="font-bold text-gray-700">Email:</span>
                                        <p class="text-gray-600">${student.email}</p>
                                    </div>
                                    <div>
                                        <span class="font-bold text-gray-700">Phone:</span>
                                        <p class="text-gray-600">${student.phone || 'N/A'}</p>
                                    </div>
                                    <div>
                                        <span class="font-bold text-gray-700">Course:</span>
                                        <p class="text-blue-600 font-bold">${student.course}</p>
                                    </div>
                                    <div>
                                        <span class="font-bold text-gray-700">Status:</span>
                                        <p class="font-bold"><span class="px-2 py-1 rounded ${student.status === 'Active' ? 'bg-green-100 text-green-700' : student.status === 'Inactive' ? 'bg-yellow-100 text-yellow-700' : 'bg-red-100 text-red-700'}">${student.status}</span></p>
                                    </div>
                                </div>
                                <div class="flex gap-2 pt-4 flex-wrap">
                                    <button onclick="openStudentEditModal(${student.id})" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition text-sm">‚úèÔ∏è Edit</button>
                                    <button onclick="deleteStudent(${student.id})" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition text-sm">üóëÔ∏è Delete</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += card;
            });
        }

        function searchStudents() {
            const search = document.getElementById('searchStudent').value.toLowerCase();
            const cards = document.querySelectorAll('#studentListView > div');
            cards.forEach(card => {
                const text = card.innerText.toLowerCase();
                card.style.display = text.includes(search) ? '' : 'none';
            });
        }

        function openStudentEditModal(studentId) {
            const student = adminStudents.find(s => s.id === studentId);
            if (!student) return;

            // Set form values
            document.getElementById('editStudentId').value = student.id;
            document.getElementById('editStudentName').value = student.name;
            document.getElementById('editStudentEmail').value = student.email;
            document.getElementById('editStudentPhone').value = student.phone || '';
            document.getElementById('editStudentCourse').value = student.course;
            document.getElementById('editStudentStatus').value = student.status;
            document.getElementById('editStudentEnrollDate').value = student.enrollDate || '';
            document.getElementById('editStudentFees').value = student.fees || '';
            document.getElementById('editStudentAddress').value = student.address || '';
            document.getElementById('editStudentAdmissionNo').value = student.admissionNo;
            document.getElementById('editStudentPassword').value = student.password || '';

            // Set photo
            if (student.photo) {
                document.getElementById('editPhotoImg').src = student.photo;
                document.getElementById('editPhotoImg').classList.remove('hidden');
                document.getElementById('editNoPhoto').classList.add('hidden');
            } else {
                document.getElementById('editPhotoImg').classList.add('hidden');
                document.getElementById('editNoPhoto').classList.remove('hidden');
            }

            // Show modal
            document.getElementById('studentEditModal').classList.remove('hidden');
        }

        function closeStudentEditModal() {
            document.getElementById('studentEditModal').classList.add('hidden');
            document.getElementById('studentEditForm').reset();
        }

        let editPhotoData = null;

        function handleEditPhotoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.size > 2 * 1024 * 1024) {
                alert('‚ùå Photo size must be less than 2MB');
                return;
            }

            if (!file.type.startsWith('image/')) {
                alert('‚ùå Please upload a valid image file');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                editPhotoData = e.target.result;
                document.getElementById('editPhotoImg').src = editPhotoData;
                document.getElementById('editPhotoImg').classList.remove('hidden');
                document.getElementById('editNoPhoto').classList.add('hidden');
            };
            reader.readAsDataURL(file);
        }

        function saveStudentChanges(event) {
            event.preventDefault();

            const studentId = parseInt(document.getElementById('editStudentId').value);
            const student = adminStudents.find(s => s.id === studentId);
            
            if (!student) return;

            // Update student data
            student.name = document.getElementById('editStudentName').value.trim();
            student.email = document.getElementById('editStudentEmail').value.trim();
            student.phone = document.getElementById('editStudentPhone').value.trim();
            student.course = document.getElementById('editStudentCourse').value;
            student.status = document.getElementById('editStudentStatus').value;
            student.enrollDate = document.getElementById('editStudentEnrollDate').value;
            student.fees = document.getElementById('editStudentFees').value;
            student.address = document.getElementById('editStudentAddress').value.trim();
            student.password = document.getElementById('editStudentPassword').value;

            // Update photo if new one was uploaded
            if (editPhotoData) {
                student.photo = editPhotoData;
                editPhotoData = null;
            }

            saveStudents();
            loadStudentsTable();
            closeStudentEditModal();
            alert('‚úÖ Student details updated successfully!');
        }

        function deleteStudent(id) {
            if (confirm('Are you sure?')) {
                adminStudents = adminStudents.filter(s => s.id !== id);
                saveStudents();
                loadStudentsTable();
                loadCredentialSelectOptions();
                alert('‚úÖ Student deleted!');
            }
        }

        function loadCredentialSelectOptions() {
            const select = document.getElementById('credentialStudent');
            select.innerHTML = '<option value="">Select Student</option>';
            adminStudents.forEach(student => {
                const option = document.createElement('option');
                option.value = student.id;
                option.textContent = `${student.name} (${student.admissionNo})`;
                select.appendChild(option);
            });
            
            select.addEventListener('change', (e) => {
                selectedStudentId = parseInt(e.target.value) || null;
                document.getElementById('admissionID').value = '';
                document.getElementById('studentPasswordField').value = '';
                if (selectedStudentId) {
                    const student = adminStudents.find(s => s.id === selectedStudentId);
                    document.getElementById('admissionID').value = student.admissionNo;
                }
            });
        }

        function generatePassword() {
            if (!selectedStudentId) {
                alert('‚ùå Please select a student!');
                return;
            }
            const chars = 'NUMBER';
            let password = '';
            for (let i = 0; i < 6; i++) {
                password += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            const student = adminStudents.find(s => s.id === selectedStudentId);
            student.password = password;
            student.status = 'Active';
            saveStudents();
            
            document.getElementById('studentPasswordField').value = password;
        }

        function sendCredentialsToStudent() {
            if (!selectedStudentId) {
                alert('‚ùå Please select a student!');
                return;
            }
            const student = adminStudents.find(s => s.id === selectedStudentId);
            if (!student.password) {
                alert('‚ùå Please generate a password first!');
                return;
            }
            
            alert('‚úÖ Credentials sent to: ' + student.email);
        }

        function saveStudents() {
            localStorage.setItem('aactiStudents', JSON.stringify(adminStudents));
        }

        // ============== EXAM MANAGEMENT ============== 
        let exams = JSON.parse(localStorage.getItem('aactiExams')) || [];
        let questionCount = 0;

        function addQuestionField() {
            questionCount++;
            const questionsContainer = document.getElementById('questionsContainer');
            const questionDiv = document.createElement('div');
            questionDiv.id = `question-${questionCount}`;
            questionDiv.className = 'bg-gray-50 p-4 rounded-lg border-l-4 border-blue-600';
            questionDiv.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <h4 class="font-bold text-indigo-900">Question ${questionCount}</h4>
                    <button type="button" onclick="removeQuestion(${questionCount})" class="text-red-600 hover:text-red-800 font-bold">üóëÔ∏è Remove</button>
                </div>
                <input type="text" placeholder="Question Text" class="input-field mb-3 question-text-${questionCount}">
                <div class="mb-3">
                    <label class="block font-bold text-gray-700 mb-2">Question Type:</label>
                    <select class="input-field question-type-${questionCount}" onchange="updateQuestionType(${questionCount})">
                        <option value="mcq">Multiple Choice (MCQ)</option>
                        <option value="short-answer">Short Answer</option>
                    </select>
                </div>
                <div id="options-${questionCount}" class="space-y-2 mb-3">
                    <label class="block font-bold text-gray-700">Options:</label>
                    <input type="text" placeholder="Option A" class="input-field option-0-${questionCount}">
                    <input type="text" placeholder="Option B" class="input-field option-1-${questionCount}">
                    <input type="text" placeholder="Option C" class="input-field option-2-${questionCount}">
                    <input type="text" placeholder="Option D" class="input-field option-3-${questionCount}">
                    <div class="mt-2">
                        <label class="block font-bold text-gray-700 mb-2">Correct Answer:</label>
                        <select class="input-field correct-answer-${questionCount}">
                            <option value="">Select Correct Answer</option>
                            <option value="A">Option A</option>
                            <option value="B">Option B</option>
                            <option value="C">Option C</option>
                            <option value="D">Option D</option>
                        </select>
                    </div>
                </div>
                <div id="short-answer-${questionCount}" class="hidden mb-3">
                    <label class="block font-bold text-gray-700 mb-2">Correct Answer:</label>
                    <input type="text" placeholder="Enter correct answer" class="input-field short-answer-text-${questionCount}">
                </div>
                <input type="number" placeholder="Marks for this question" class="input-field question-marks-${questionCount}" value="1">
            `;
            questionsContainer.appendChild(questionDiv);
        }

        function removeQuestion(qNum) {
            const qElement = document.getElementById(`question-${qNum}`);
            if (qElement) {
                qElement.remove();
            }
        }

        function updateQuestionType(qNum) {
            const type = document.querySelector(`.question-type-${qNum}`).value;
            const optionsDiv = document.getElementById(`options-${qNum}`);
            const shortAnswerDiv = document.getElementById(`short-answer-${qNum}`);
            
            if (type === 'mcq') {
                optionsDiv.classList.remove('hidden');
                shortAnswerDiv.classList.add('hidden');
            } else {
                optionsDiv.classList.add('hidden');
                shortAnswerDiv.classList.remove('hidden');
            }
        }

        function saveExam() {
            const title = document.getElementById('examTitle').value.trim();
            const course = document.getElementById('examCourse').value;
            const description = document.getElementById('examDescription').value.trim();
            const totalMarks = parseInt(document.getElementById('examTotalMarks').value) || 0;
            const passMarks = parseInt(document.getElementById('examPassMarks').value) || 0;
            const duration = parseInt(document.getElementById('examDuration').value) || 30;

            if (!title || !course) {
                alert('‚ùå Please fill Exam Title and Course!');
                return;
            }

            const questionsElements = document.querySelectorAll('[id^="question-"]');
            const questions = [];
            let calcMarks = 0;

            questionsElements.forEach((qElement) => {
                const qId = qElement.id.replace('question-', '');
                const qText = document.querySelector(`.question-text-${qId}`).value.trim();
                const qType = document.querySelector(`.question-type-${qId}`).value;
                const qMarks = parseInt(document.querySelector(`.question-marks-${qId}`).value) || 1;

                if (!qText) {
                    alert('‚ùå All questions must have text!');
                    return;
                }

                let question = {
                    id: qId,
                    text: qText,
                    type: qType,
                    marks: qMarks
                };

                if (qType === 'mcq') {
                    const options = [
                        document.querySelector(`.option-0-${qId}`).value.trim(),
                        document.querySelector(`.option-1-${qId}`).value.trim(),
                        document.querySelector(`.option-2-${qId}`).value.trim(),
                        document.querySelector(`.option-3-${qId}`).value.trim()
                    ];
                    const correctAnswer = document.querySelector(`.correct-answer-${qId}`).value;

                    if (options.some(opt => !opt) || !correctAnswer) {
                        alert('‚ùå All options and correct answer must be filled!');
                        return;
                    }
                    question.options = options;
                    question.correctAnswer = correctAnswer;
                } else {
                    const correctAnswer = document.querySelector(`.short-answer-text-${qId}`).value.trim();
                    if (!correctAnswer) {
                        alert('‚ùå Correct answer must be filled for all questions!');
                        return;
                    }
                    question.correctAnswer = correctAnswer;
                }

                calcMarks += qMarks;
                questions.push(question);
            });

            if (questions.length === 0) {
                alert('‚ùå Please add at least one question!');
                return;
            }

            const exam = {
                id: Date.now(),
                title,
                course,
                description,
                totalMarks: calcMarks,
                passMarks: passMarks || Math.ceil(calcMarks * 0.4),
                duration,
                questions,
                createdAt: new Date().toLocaleDateString(),
                createdBy: 'Admin'
            };

            exams.push(exam);
            localStorage.setItem('aactiExams', JSON.stringify(exams));

            alert('‚úÖ Exam Created Successfully!\n\nExam: ' + title + '\nTotal Questions: ' + questions.length + '\nTotal Marks: ' + exam.totalMarks);
            resetExamForm();
            loadExamsList();
        }

        function resetExamForm() {
            document.getElementById('examTitle').value = '';
            document.getElementById('examCourse').value = '';
            document.getElementById('examDescription').value = '';
            document.getElementById('examTotalMarks').value = '100';
            document.getElementById('examPassMarks').value = '40';
            document.getElementById('examDuration').value = '30';
            document.getElementById('questionsContainer').innerHTML = '';
            questionCount = 0;
        }

        function loadExamsList() {
            const container = document.getElementById('examsListContainer');
            container.innerHTML = '';

            if (exams.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-600 py-8">No exams created yet.</p>';
                return;
            }

            exams.forEach(exam => {
                const examCard = document.createElement('div');
                examCard.className = 'bg-gradient-to-r from-purple-50 to-blue-50 p-6 rounded-lg border-l-4 border-purple-600 hover:shadow-lg transition';
                examCard.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h3 class="text-xl font-bold text-indigo-900">${exam.title}</h3>
                            <p class="text-sm text-gray-600">Course: <span class="font-bold">${exam.course}</span> | Created: ${exam.createdAt}</p>
                        </div>
                        <button onclick="deleteExam(${exam.id})" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded font-bold">üóëÔ∏è Delete</button>
                    </div>
                    <p class="text-gray-700 mb-3">${exam.description}</p>
                    <div class="grid grid-cols-4 gap-2 text-sm text-center">
                        <div class="bg-white p-2 rounded border border-purple-300">
                            <p class="font-bold text-purple-900">${exam.questions.length}</p>
                            <p class="text-gray-600 text-xs">Questions</p>
                        </div>
                        <div class="bg-white p-2 rounded border border-blue-300">
                            <p class="font-bold text-blue-900">${exam.totalMarks}</p>
                            <p class="text-gray-600 text-xs">Marks</p>
                        </div>
                        <div class="bg-white p-2 rounded border border-green-300">
                            <p class="font-bold text-green-900">${exam.passMarks}</p>
                            <p class="text-gray-600 text-xs">Pass</p>
                        </div>
                        <div class="bg-white p-2 rounded border border-orange-300">
                            <p class="font-bold text-orange-900">${exam.duration}</p>
                            <p class="text-gray-600 text-xs">Min</p>
                        </div>
                    </div>
                `;
                container.appendChild(examCard);
            });
        }

        function deleteExam(examId) {
            if (confirm('Are you sure you want to delete this exam?')) {
                exams = exams.filter(e => e.id !== examId);
                localStorage.setItem('aactiExams', JSON.stringify(exams));
                loadExamsList();
                alert('‚úÖ Exam deleted!');
            }
        }

        function searchExams() {
            const search = document.getElementById('searchExam').value.toLowerCase();
            const cards = document.querySelectorAll('#examsListContainer > div');
            cards.forEach(card => {
                const text = card.innerText.toLowerCase();
                card.style.display = text.includes(search) ? '' : 'none';
            });
        }

        // ============== FEE MANAGEMENT FUNCTIONS ==============
        let studentFees = JSON.parse(localStorage.getItem('aactiStudentFees')) || {};

        // Initialize student fees structure
        function initializeStudentFees() {
            adminStudents.forEach(student => {
                if (!studentFees[student.id]) {
                    studentFees[student.id] = {
                        studentId: student.id,
                        studentName: student.name,
                        admissionNo: student.admissionNo,
                        course: student.course,
                        totalFees: parseInt(student.fees) || 0,
                        paidAmount: 0,
                        transactions: [],
                        lastPaymentDate: null
                    };
                }
            });
            localStorage.setItem('aactiStudentFees', JSON.stringify(studentFees));
        }

        function switchFeeTab(tab) {
            document.querySelectorAll('.fee-tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(tab).classList.remove('hidden');
            
            if (tab === 'studentFees') {
                loadStudentFeesTable();
            } else if (tab === 'collectFee') {
                loadFeeStudentOptions();
            } else if (tab === 'feeReport') {
                generateFeeReport();
            }
            updateFeeSummary();
        }

        function updateFeeSummary() {
            initializeStudentFees();
            let totalCollected = 0;
            let totalPending = 0;
            let overdueCount = 0;

            Object.values(studentFees).forEach(fee => {
                totalCollected += fee.paidAmount || 0;
                totalPending += (fee.totalFees - (fee.paidAmount || 0));
                if ((fee.totalFees - (fee.paidAmount || 0)) > 0 && fee.lastPaymentDate) {
                    const lastPayment = new Date(fee.lastPaymentDate);
                    const daysPassed = Math.floor((new Date() - lastPayment) / (1000 * 60 * 60 * 24));
                    if (daysPassed > 30) overdueCount++;
                }
            });

            document.getElementById('totalStudentsCount').textContent = adminStudents.length;
            document.getElementById('totalCollected').textContent = '‚Çπ' + totalCollected.toLocaleString();
            document.getElementById('totalPending').textContent = '‚Çπ' + totalPending.toLocaleString();
            document.getElementById('overdueCount').textContent = overdueCount;
        }

        function loadStudentFeesTable() {
            initializeStudentFees();
            const tbody = document.getElementById('studentFeesTable');
            tbody.innerHTML = '';

            Object.values(studentFees).forEach(fee => {
                const pendingAmount = fee.totalFees - (fee.paidAmount || 0);
                const paidPercentage = ((fee.paidAmount || 0) / fee.totalFees * 100).toFixed(0);
                let statusClass = 'bg-red-100 text-red-700';
                let statusText = 'Pending';
                if (pendingAmount === 0) {
                    statusClass = 'bg-green-100 text-green-700';
                    statusText = 'Paid';
                } else if (fee.paidAmount > 0) {
                    statusClass = 'bg-yellow-100 text-yellow-700';
                    statusText = 'Partial';
                }

                const row = `
                    <tr class="border hover:bg-indigo-50">
                        <td class="border p-3">${fee.studentName}</td>
                        <td class="border p-3 font-bold">${fee.admissionNo}</td>
                        <td class="border p-3"><span class="bg-blue-100 px-2 py-1 rounded">${fee.course}</span></td>
                        <td class="border p-3 text-right font-bold">‚Çπ${fee.totalFees.toLocaleString()}</td>
                        <td class="border p-3 text-right text-green-700 font-bold">‚Çπ${(fee.paidAmount || 0).toLocaleString()}</td>
                        <td class="border p-3 text-right text-red-700 font-bold">‚Çπ${pendingAmount.toLocaleString()}</td>
                        <td class="border p-3 text-center">
                            <span class="px-2 py-1 rounded font-bold ${statusClass}">${statusText}</span>
                        </td>
                        <td class="border p-3 text-center">
                            <button onclick="openFeeCollection(${fee.studentId})" class="text-blue-600 hover:underline text-sm font-bold">üí∞ Collect</button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function searchFeeStudents() {
            const search = document.getElementById('searchFeeStudent').value.toLowerCase();
            const rows = document.querySelectorAll('#studentFeesTable tr');
            rows.forEach(row => {
                const text = row.innerText.toLowerCase();
                row.style.display = text.includes(search) ? '' : 'none';
            });
        }

        function loadFeeStudentOptions() {
            initializeStudentFees();
            const select = document.getElementById('feeStudent');
            select.innerHTML = '<option value="">Select Student</option>';

            adminStudents.forEach(student => {
                const option = document.createElement('option');
                option.value = student.id;
                option.textContent = `${student.name} (${student.admissionNo})`;
                select.appendChild(option);
            });
        }

        function openFeeCollection(studentId) {
            document.getElementById('feeStudent').value = studentId;
            loadStudentFeeDetails();
            switchFeeTab('collectFee');
        }

        function loadStudentFeeDetails() {
            initializeStudentFees();
            const studentId = parseInt(document.getElementById('feeStudent').value);
            
            if (!studentId || !studentFees[studentId]) {
                alert('Please select a valid student');
                return;
            }

            const fee = studentFees[studentId];
            const pendingAmount = fee.totalFees - (fee.paidAmount || 0);

            document.getElementById('displayTotalFees').textContent = '‚Çπ' + fee.totalFees.toLocaleString();
            document.getElementById('displayPaidAmount').textContent = '‚Çπ' + (fee.paidAmount || 0).toLocaleString();
            document.getElementById('displayPendingAmount').textContent = '‚Çπ' + pendingAmount.toLocaleString();
            document.getElementById('feeAmount').max = pendingAmount;
            document.getElementById('feeAmount').value = '';
            document.getElementById('feePaymentMode').value = '';
            document.getElementById('feePaymentDate').valueAsDate = new Date();
            document.getElementById('feeNotes').value = '';
        }

        function collectStudentFee() {
            const studentId = parseInt(document.getElementById('feeStudent').value);
            const amount = parseInt(document.getElementById('feeAmount').value) || 0;
            const mode = document.getElementById('feePaymentMode').value;
            const date = document.getElementById('feePaymentDate').value;
            const notes = document.getElementById('feeNotes').value;

            if (!studentId || amount <= 0 || !mode || !date) {
                alert('‚ùå Please fill all required fields!');
                return;
            }

            initializeStudentFees();
            const fee = studentFees[studentId];
            const pendingAmount = fee.totalFees - (fee.paidAmount || 0);

            if (amount > pendingAmount) {
                alert(`‚ùå Cannot collect more than pending amount (‚Çπ${pendingAmount})`);
                return;
            }

            fee.paidAmount = (fee.paidAmount || 0) + amount;
            fee.lastPaymentDate = date;
            const transaction = {
                amount: amount,
                mode: mode,
                date: date,
                notes: notes,
                timestamp: new Date().toISOString(),
                receiptNo: `RCP-${Date.now()}`
            };
            fee.transactions.push(transaction);

            localStorage.setItem('aactiStudentFees', JSON.stringify(studentFees));
            alert(`‚úÖ Payment of ‚Çπ${amount} recorded successfully!`);
            
            // Generate and download receipt
            const student = adminStudents.find(s => s.id === studentId);
            if (student) {
                downloadPaymentReceipt(student, fee, transaction);
            }
            
            document.getElementById('feeAmount').value = '';
            loadStudentFeeDetails();
            loadStudentFeesTable();
            updateFeeSummary();
        }

        function downloadPaymentReceipt(student, fee, transaction) {
            const element = document.createElement('div');
            const paidAmount = fee.paidAmount || 0;
            const pendingAmount = fee.totalFees - paidAmount;
            
            element.innerHTML = `
                <div style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 35px; max-width: 800px; margin: 0 auto; color: #1f2937;">
                    <!-- Header -->
                    <div style="background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); color: white; padding: 30px; border-radius: 12px 12px 0 0; text-align: center; margin-bottom: 0;">
                        <p style="margin: 0; font-size: 28px; font-weight: 900; letter-spacing: 1px;">AAYAT ACADEMY</p>
                        <p style="margin: 5px 0 0 0; font-size: 12px; opacity: 0.95;">üéì Computer Training Institute</p>
                        <div style="border-top: 2px solid rgba(255,255,255,0.3); border-bottom: 2px solid rgba(255,255,255,0.3); padding: 10px 0; margin: 10px 0;">
                            <h2 style="color: #fbbf24; margin: 0; font-size: 20px; font-weight: bold;">FEE PAYMENT RECEIPT</h2>
                        </div>
                    </div>

                    <!-- Receipt Details -->
                    <div style="background: white; border: 1px solid #e5e7eb; border-top: none; padding: 25px;">
                        <!-- Top Section -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 25px;">
                            <div>
                                <h3 style="margin: 0 0 15px 0; color: #4f46e5; font-weight: 700; font-size: 13px; text-transform: uppercase;">Receipt Information</h3>
                                <table style="width: 100%; font-size: 12px;">
                                    <tr>
                                        <td style="padding: 5px 0; font-weight: 600; color: #6b7280;">Receipt No.:</td>
                                        <td style="padding: 5px 0; text-align: right; font-family: 'Courier New'; font-weight: bold; color: #4f46e5;">${transaction.receiptNo}</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 5px 0; font-weight: 600; color: #6b7280;">Payment Date:</td>
                                        <td style="padding: 5px 0; text-align: right;">${new Date(transaction.date).toLocaleDateString('en-IN')}</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 5px 0; font-weight: 600; color: #6b7280;">Generated On:</td>
                                        <td style="padding: 5px 0; text-align: right; font-size: 11px;">${new Date().toLocaleString('en-IN')}</td>
                                    </tr>
                                </table>
                            </div>

                            <div>
                                <h3 style="margin: 0 0 15px 0; color: #4f46e5; font-weight: 700; font-size: 13px; text-transform: uppercase;">Student Information</h3>
                                <table style="width: 100%; font-size: 12px;">
                                    <tr>
                                        <td style="padding: 5px 0; font-weight: 600; color: #6b7280;">Student Name:</td>
                                        <td style="padding: 5px 0; text-align: right; font-weight: 600;">${student.name}</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 5px 0; font-weight: 600; color: #6b7280;">Admission ID:</td>
                                        <td style="padding: 5px 0; text-align: right; font-family: 'Courier New'; font-weight: bold; color: #4f46e5;">${student.admissionNo}</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 5px 0; font-weight: 600; color: #6b7280;">Course:</td>
                                        <td style="padding: 5px 0; text-align: right;">${student.course}</td>
                                    </tr>
                                </table>
                            </div>
                        </div>

                        <!-- Payment Details Box -->
                        <div style="background: linear-gradient(135deg, #f0f4ff 0%, #f5f3ff 100%); border: 2px solid #4f46e5; border-radius: 10px; padding: 20px; margin-bottom: 25px;">
                            <h3 style="margin: 0 0 15px 0; color: #1f2937; font-weight: 700; font-size: 13px;">Payment Details</h3>
                            <table style="width: 100%;">
                                <tr style="border-bottom: 1px solid #d1d5db;">
                                    <td style="padding: 12px 0; font-weight: 600; color: #374151;">Total Course Fees:</td>
                                    <td style="padding: 12px 0; text-align: right; font-weight: 600; font-size: 14px;">‚Çπ${fee.totalFees.toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #d1d5db;">
                                    <td style="padding: 12px 0; font-weight: 600; color: #374151;">Previously Paid:</td>
                                    <td style="padding: 12px 0; text-align: right; color: #059669; font-weight: 600;">‚Çπ${(paidAmount - transaction.amount).toLocaleString()}</td>
                                </tr>
                                <tr style="border-bottom: 2px solid #4f46e5; background-color: rgba(79, 70, 229, 0.05);">
                                    <td style="padding: 12px 0; font-weight: 700; color: #4f46e5; font-size: 14px;">Payment Amount (Today):</td>
                                    <td style="padding: 12px 0; text-align: right; font-weight: 900; color: #059669; font-size: 16px;">‚Çπ${transaction.amount.toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px 0; font-weight: 600; color: #374151;">Total Paid Till Date:</td>
                                    <td style="padding: 12px 0; text-align: right; font-weight: 700; color: #059669; font-size: 14px;">‚Çπ${paidAmount.toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px 0; font-weight: 700; color: #dc2626; font-size: 14px;">Remaining Balance:</td>
                                    <td style="padding: 12px 0; text-align: right; font-weight: 900; color: #dc2626; font-size: 16px;">‚Çπ${pendingAmount.toLocaleString()}</td>
                                </tr>
                            </table>
                        </div>

                        <!-- Payment Method -->
                        <div style="background: #f9fafb; padding: 15px; border-radius: 8px; border-left: 4px solid #fbbf24; margin-bottom: 25px;">
                            <p style="margin: 0 0 8px 0; font-weight: 700; color: #1f2937; font-size: 12px;">Payment Method</p>
                            <p style="margin: 0; font-size: 13px; font-weight: 600; color: #374151;"><span style="background: #fef3c7; padding: 4px 10px; border-radius: 4px;">${transaction.mode}</span></p>
                            ${transaction.notes ? `<p style="margin: 8px 0 0 0; font-size: 11px; color: #6b7280;"><strong>Notes:</strong> ${transaction.notes}</p>` : ''}
                        </div>

                        <!-- Status -->
                        <div style="background: ${pendingAmount === 0 ? '#d1fae5' : '#fef3c7'}; border-left: 4px solid ${pendingAmount === 0 ? '#10b981' : '#f59e0b'}; padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 25px;">
                            <p style="margin: 0; font-weight: 700; color: ${pendingAmount === 0 ? '#065f46' : '#92400e'}; font-size: 13px;">
                                ${pendingAmount === 0 ? '‚úÖ FULLY PAID - NO BALANCE DUE' : '‚è≥ PARTIAL PAYMENT - BALANCE PENDING'}
                            </p>
                        </div>

                        <!-- Footer -->
                        <div style="border-top: 2px solid #e5e7eb; padding-top: 20px; text-align: center;">
                            <p style="margin: 0 0 10px 0; font-size: 12px; font-weight: 600; color: #1f2937;">Authorized By</p>
                            <p style="margin: 25px 0 0 0; height: 1px; background: #1f2937;"></p>
                            <p style="margin: 8px 0; font-size: 10px; color: #6b7280;">Admin Signature & Date</p>
                        </div>
                    </div>

                    <!-- Footer Note -->
                    <div style="background: linear-gradient(135deg, #f0f4ff 0%, #f5f3ff 100%); padding: 15px; border: 1px solid #4f46e5; border-top: none; border-radius: 0 0 12px 12px; text-align: center; font-size: 9px; color: #6b7280;">
                        <p style="margin: 5px 0;">This is a computer-generated receipt. No signature required.</p>
                        <p style="margin: 3px 0; font-weight: 600; color: #4f46e5;">AAYAT ACADEMY | Contact: 8181867118 | Email: info@aacti.in</p>
                        <p style="margin: 3px 0;">Please keep this receipt for your records.</p>
                    </div>
                </div>
            `;

            const options = {
                margin: 8,
                filename: `${transaction.receiptNo}_PaymentReceipt.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { orientation: 'portrait', unit: 'mm', format: 'a4' }
            };

            html2pdf().set(options).from(element).save();
        }

        function generateFeeReport() {
            initializeStudentFees();
            const course = document.getElementById('reportCourse').value;
            const status = document.getElementById('reportStatus').value;
            const tbody = document.getElementById('feeReportTable');
            tbody.innerHTML = '';

            let filteredFees = Object.values(studentFees);

            if (course) {
                filteredFees = filteredFees.filter(f => f.course === course);
            }

            filteredFees.forEach(fee => {
                const pendingAmount = fee.totalFees - (fee.paidAmount || 0);
                let feeStatus = 'Pending';
                if (pendingAmount === 0) feeStatus = 'Paid';
                else if (fee.paidAmount > 0) feeStatus = 'Partial';

                if (status && feeStatus !== status) return;

                const paidPercent = ((fee.paidAmount || 0) / fee.totalFees * 100).toFixed(0);
                let statusClass = 'bg-red-100 text-red-700';
                if (feeStatus === 'Paid') statusClass = 'bg-green-100 text-green-700';
                else if (feeStatus === 'Partial') statusClass = 'bg-yellow-100 text-yellow-700';

                const row = `
                    <tr class="border hover:bg-indigo-50">
                        <td class="border p-3">${fee.studentName}</td>
                        <td class="border p-3">${fee.course}</td>
                        <td class="border p-3 text-right font-bold">‚Çπ${fee.totalFees.toLocaleString()}</td>
                        <td class="border p-3 text-right text-green-700 font-bold">‚Çπ${(fee.paidAmount || 0).toLocaleString()}</td>
                        <td class="border p-3 text-right text-red-700 font-bold">‚Çπ${pendingAmount.toLocaleString()}</td>
                        <td class="border p-3 text-center font-bold">${paidPercent}%</td>
                        <td class="border p-3 text-center"><span class="px-2 py-1 rounded font-bold ${statusClass}">${feeStatus}</span></td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function downloadFeeReport() {
            initializeStudentFees();
            let csvContent = "Student Name,Admission No.,Course,Total Fees,Paid Amount,Pending Amount,Status\n";
            
            Object.values(studentFees).forEach(fee => {
                const pendingAmount = fee.totalFees - (fee.paidAmount || 0);
                let feeStatus = 'Pending';
                if (pendingAmount === 0) feeStatus = 'Paid';
                else if (fee.paidAmount > 0) feeStatus = 'Partial';

                csvContent += `"${fee.studentName}","${fee.admissionNo}","${fee.course}",${fee.totalFees},${fee.paidAmount || 0},${pendingAmount},"${feeStatus}"\n`;
            });

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Fee_Report_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Check if admin already logged in
        window.addEventListener('load', () => {
            loadExamsList();
            initializeStudentFees();
            if (localStorage.getItem('adminLoggedIn') === 'true') {
                document.getElementById('adminLoginSection').classList.add('hidden');
                document.getElementById('adminPanelSection').classList.remove('hidden');
                loadStudentsTable();
                loadCredentialSelectOptions();
                updateFeeSummary();
                switchAdminTab('addStudent');
            }
        });

        // ============== AACTI CHATBOT FUNCTIONS ==============
        const chatbotResponses = {
            admission: [
                "üéì For admission, please visit: https://aacti.aisc.in/online_admission or call us at 8181867118",
                "üìã You can fill the admission form online at our website. Required documents: 10th Pass Certificate, Aadhar Card, and a recent photo"
            ],
            course: [
                "üìö We offer courses in: CCC, ADCA, DCA, BCA, Python, Java, Tally, and O-LEVEL (NIELIT)",
                "üíª Choose a course based on your interest and career goals. Our counselors can guide you!"
            ],
            fees: [
                "üí∞ Fees vary by course. For detailed fee structure, contact us at 8181867118 or visit our website",
                "üí≥ We offer flexible payment options and scholarship programs for eligible students"
            ],
            exam: [
                "üìù You can take exams from your Student Portal after logging in with your admission ID",
                "‚úèÔ∏è Exams include MCQ and short-answer questions. You'll get instant results with detailed answers"
            ],
            result: [
                "üìä Check your exam results in the 'My Results' section of your Student Portal",
                "‚úÖ Results show your score, percentage, pass/fail status, and answer key for review"
            ],
            study: [
                "üìñ Access all study materials from the 'Study Notes' section on our home page",
                "üé¨ Follow our YouTube channel for video tutorials: https://www.youtube.com/@aacti"
            ],
            help: [
                "üÜò Need technical help? Contact us at 8181867118 or WhatsApp: https://whatsapp.com/channel/0029Va4qzgn1noz8smaD8J2q",
                "üìû Our support team is available during business hours to assist you"
            ],
            contact: [
                "üì± Call us: +91 8181867118\nüìß Connect on: Instagram, YouTube, WhatsApp, Telegram",
                "üè¢ Visit our official website: https://aacti.aisc.in/"
            ],
            hello: [
                "üëã Hello! How can I help you today?",
                "üôè Welcome to AACTI! What can I assist you with?"
            ],
            thanks: [
                "üòä You're welcome! Feel free to ask if you need anything else",
                "üôè Happy to help! Don't hesitate to reach out again"
            ],
            problem: [
                "üîß Please describe your problem in detail. I'll try my best to help you!",
                "‚ùì You can ask me about: admission, courses, fees, exams, results, or study materials"
            ]
        };

        function toggleChatbot() {
            const modal = document.getElementById('chatbotModal');
            if (modal) {
                modal.classList.toggle('hidden');
                if (!modal.classList.contains('hidden')) {
                    setTimeout(() => {
                        const input = document.getElementById('chatInput');
                        if (input) input.focus();
                    }, 100);
                }
            }
        }

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const messagesContainer = document.getElementById('chatMessages');
            const typingIndicator = document.getElementById('typingIndicator');
            
            const userMessage = input.value.trim();
            
            if (!userMessage) return;

            // Display user message
            const userMsgDiv = document.createElement('div');
            userMsgDiv.className = 'bg-purple-600 text-white p-3 rounded-lg rounded-tr-none text-sm ml-auto max-w-xs';
            userMsgDiv.textContent = userMessage;
            messagesContainer.appendChild(userMsgDiv);
            input.value = '';
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            // Show typing indicator
            typingIndicator.classList.remove('hidden');

            // Get bot response after delay
            setTimeout(() => {
                typingIndicator.classList.add('hidden');
                
                let botResponse = "I'm not sure about that. Could you please ask about: admission, courses, fees, exams, results, or study materials?";
                const lowerMessage = userMessage.toLowerCase();

                // Keyword matching
                for (const [keyword, responses] of Object.entries(chatbotResponses)) {
                    if (lowerMessage.includes(keyword)) {
                        botResponse = getRandomResponse(responses);
                        break;
                    }
                }

                const botMsgDiv = document.createElement('div');
                botMsgDiv.className = 'bg-blue-100 text-blue-900 p-3 rounded-lg rounded-tl-none text-sm max-w-xs';
                botMsgDiv.textContent = botResponse;
                messagesContainer.appendChild(botMsgDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, 800);
        }

        function getRandomResponse(responses) {
            return responses[Math.floor(Math.random() * responses.length)];
        }
    </script>
</body>
</html>
